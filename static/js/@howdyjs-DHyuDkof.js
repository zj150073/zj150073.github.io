var e=(e,n,t)=>new Promise(((i,a)=>{var _=e=>{try{o(t.next(e))}catch(n){a(n)}},m=e=>{try{o(t.throw(e))}catch(n){a(n)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(_,m);o((t=t.apply(e,n)).next())}));import{d as n,r as t,b as i,w as a,n as _,e as m,o,f as u,c as r,F as d,g as s,m as l,t as c,h as b,i as v,v as p,j as h,k as f,l as y,a as g,p as w,q as x,T as C,s as S,u as k}from"./@vue-CFXrvzpc.js";const M=function(e){let n=Array.isArray(e)?[]:{};if(e&&"object"==typeof e)for(let t in e)e.hasOwnProperty(t)&&(e[t]&&"object"==typeof e[t]?n[t]=M(e[t]):n[t]=e[t]);return n};var z=n({name:"MouseMenu",props:{appendToBody:{type:Boolean,default:!0},menuWidth:{type:Number,default:200},menuList:{type:Array,required:!0},menuHiddenFn:{type:Function},hasIcon:{type:Boolean,default:!1},iconType:{type:String,default:"font-icon"},menuWrapperCss:Object,menuItemCss:Object,el:{type:Object,required:!0},params:{type:[String,Number,Array,Object]},useLongPressInMobile:Boolean,longPressDuration:Number,longPressPreventDefault:[Function,Boolean],injectCloseListener:{type:Boolean,default:!0},customClass:String,disabled:{type:Function}},emits:["open","close"],setup(n,{emit:o}){const u=t(0),r=t(0),d=t(!1),s=t(0),l=t(0),c=t(!1),b=t(null),v=t([]),p=i((()=>n.menuList.some((e=>e.children&&e.children.length>0)))),h=t(10),f=t();a(c,(t=>e(this,null,(function*(){var e,i;if(t){yield _();let t=f.value;n.menuWrapperCss&&Object.keys(n.menuWrapperCss).map((e=>{t.style.setProperty(`--menu-${e}`,n.menuWrapperCss&&n.menuWrapperCss[e])})),n.menuItemCss&&Object.keys(n.menuItemCss).map((e=>{t.style.setProperty(`--menu-item-${e}`,n.menuItemCss&&n.menuItemCss[e])}));let a=null==(i=null==(e=n.menuItemCss)?void 0:e.arrowSize)?void 0:i.match(/\d+/);h.value=a&&~~a[0]||10,t.style.setProperty("--menu-item-arrowRealSize",h.value/2+"px"),o("open",n.params,b.value,n.el)}else o("close",n.params,b.value,n.el)}))));const y=(e,n,t,i)=>e.map((e=>(e.children&&(e.children=y(e.children,n,t,i)),e.label&&"function"==typeof e.label&&(e.label=e.label(i,n,t)),e.tips&&"function"==typeof e.tips&&(e.tips=e.tips(i,n,t)),e.icon&&"function"==typeof e.icon&&(e.icon=e.icon(i,n,t)),e.hidden&&"function"==typeof e.hidden&&(e.hidden=e.hidden(i,n,t)),e.disabled&&"function"==typeof e.disabled&&(e.disabled=e.disabled(i,n,t)),e))),g=i((()=>n.useLongPressInMobile&&"ontouchstart"in window?"touchstart":"mousedown")),w=e=>{f.value&&!f.value.contains(e.currentTarget)&&(c.value=!1,document.oncontextmenu=null)};return a((()=>n.injectCloseListener),(e=>{e?document.addEventListener(g.value,w):document.removeEventListener(g.value,w)}),{immediate:!0}),m((()=>{document.removeEventListener(g.value,w)})),{subLeft:u,subTop:r,hoverFlag:d,menuTop:s,menuLeft:l,showMenu:c,clickDomEl:b,calcMenuList:v,arrowSize:h,hasSubMenu:p,MenuWrapper:f,handleMenuItemClick:(e,t)=>{e.disabled||(e.fn&&"function"==typeof e.fn&&e.fn(n.params,b.value,n.el,t),c.value=!1)},handleSubMenuItemClick:(e,t)=>{e.disabled||(e.fn&&"function"==typeof e.fn&&!e.disabled&&(e.fn(n.params,b.value,n.el,t),d.value=!1),c.value=!1)},handleMenuMouseEnter:(e,n)=>{if(n.children&&!n.disabled){d.value=!0;const n=e.currentTarget;if(!n)return;const{offsetWidth:t}=n,i=n.querySelector(".__menu__sub__wrapper");if(!i)return;const{offsetWidth:a,offsetHeight:_}=i,{innerWidth:m,innerHeight:o}=window,{top:s,left:l}=n.getBoundingClientRect();u.value=l+t+a>m-5?l-a+5:l+t,r.value=s+_>o-5?o-_:s+5}},show:(t=0,i=0)=>e(this,null,(function*(){if(b.value=document.elementFromPoint(t-1,i-1),n.menuHiddenFn?c.value=!n.menuHiddenFn(n.params,b.value,n.el):c.value=!0,!c.value)return;v.value=M(n.menuList),v.value=y(v.value,b.value,n.el,n.params),yield _();const{innerWidth:e,innerHeight:a}=window,m=f.value.offsetHeight,o=n.menuWidth||200;l.value=t+o+1>e?e-o-5:t+1,s.value=i+m+1>a?a-m-5:i+1})),close:()=>{c.value=!1},clickEventKey:g}}});const L=["onMouseenter"],T={key:0,class:"__menu__item-icon"},I=["innerHTML"],F={class:"__menu__item-label"},j={class:"__menu__item-tips"},W={class:"__menu__item-arrow-after"},B={class:"__menu__sub__item-label"},E={class:"__menu__sub__item-tips"};function P(e){var n;const t="__mouse__menu__container";let i;i=document.querySelector(`.${t}`)?document.querySelector(`.${t}`):function(e,n){let t=document.createElement(e);return t.setAttribute("class",n),t}("div",t);const a=S(z,e);return k(a,i),document.body.appendChild(i),null==(n=a.component)?void 0:n.proxy}!function(e,n){void 0===n&&(n={});var t=n.insertAt;if("undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===t&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}(".__menu__mask[data-v-3d21bc0a] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  z-index: 999;\n}\n.__menu__wrapper[data-v-3d21bc0a] {\n  --menu-background: #c8f2f0;\n  --menu-boxShadow: 0 1px 5px #888;\n  --menu-padding: 5px 0;\n  --menu-borderRadius: 0;\n  --menu-item-height: 30px;\n  --menu-item-padding: 0 10px;\n  --menu-item-iconSize: 20px;\n  --menu-item-iconFontSize: 14px;\n  --menu-item-iconColor: #484852;\n  --menu-item-labelColor: #484852;\n  --menu-item-labelFontSize: 14px;\n  --menu-item-tipsColor: #889;\n  --menu-item-tipsFontSize: 12px;\n  --menu-item-arrowColor: #484852;\n  --menu-item-disabledColor: #bcc;\n  --menu-item-hoverBackground: rgba(255, 255, 255, 0.8);\n  --menu-item-hoverIconColor: inherit;\n  --menu-item-hoverLabelColor: inherit;\n  --menu-item-hoverTipsColor: inherit;\n  --menu-item-hoverArrowColor: inherit;\n  --menu-lineColor: #ccc;\n  --menu-lineMargin: 5px 0;\n}\n.__menu__wrapper[data-v-3d21bc0a] {\n  position: fixed;\n  width: 200px;\n  background: var(--menu-background);\n  box-shadow: var(--menu-boxShadow);\n  padding: var(--menu-padding);\n  border-radius: var(--menu-borderRadius);\n  z-index: 99999;\n}\n.__menu__line[data-v-3d21bc0a],\n.__menu__sub__line[data-v-3d21bc0a] {\n  border-top: 1px solid var(--menu-lineColor);\n  margin: var(--menu-lineMargin);\n}\n.__menu__item[data-v-3d21bc0a],\n.__menu__sub__item[data-v-3d21bc0a] {\n  display: flex;\n  height: var(--menu-item-height);\n  align-items: center;\n  cursor: pointer;\n  padding: var(--menu-item-padding);\n}\n.__menu__item .__menu__item-icon[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-icon[data-v-3d21bc0a] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: var(--menu-item-iconColor);\n  width: var(--menu-item-iconSize);\n  height: var(--menu-item-iconSize);\n}\n.__menu__item .__menu__item-icon i[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-icon i[data-v-3d21bc0a] {\n  font-size: var(--menu-item-iconFontSize);\n}\n.__menu__item .__menu__item-icon .__menu__item-icon-svg[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-icon .__menu__item-icon-svg[data-v-3d21bc0a] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n}\n.__menu__item .__menu__item-label[data-v-3d21bc0a],\n.__menu__item .__menu__sub__item-label[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-label[data-v-3d21bc0a],\n.__menu__sub__item .__menu__sub__item-label[data-v-3d21bc0a] {\n  width: 100%;\n  max-height: 100%;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  flex: 1;\n  font-size: var(--menu-item-labelFontSize);\n  color: var(--menu-item-labelColor);\n  margin-right: 5px;\n  overflow: hidden;\n}\n.__menu__item .__menu__item-tips[data-v-3d21bc0a],\n.__menu__item .__menu__sub__item-tips[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-tips[data-v-3d21bc0a],\n.__menu__sub__item .__menu__sub__item-tips[data-v-3d21bc0a] {\n  font-size: var(--menu-item-tipsFontSize);\n  color: var(--menu-item-tipsColor);\n}\n.__menu__item .__menu__item-arrow[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-arrow[data-v-3d21bc0a] {\n  width: 10px;\n  height: 10px;\n  margin-left: 5px;\n  position: relative;\n}\n.__menu__item.disabled[data-v-3d21bc0a],\n.__menu__sub__item.disabled[data-v-3d21bc0a] {\n  cursor: not-allowed;\n}\n.__menu__item.disabled .__menu__item-icon[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__item-label[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__sub__item-label[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__item-tips[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__sub__item-tips[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-icon[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-label[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__sub__item-label[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-tips[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__sub__item-tips[data-v-3d21bc0a] {\n  color: var(--menu-item-disabledColor);\n}\n.__menu__item.disabled .__menu__item-arrow .__menu__item-arrow-after[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-arrow .__menu__item-arrow-after[data-v-3d21bc0a] {\n  border-left: var(--menu-item-arrowRealSize) solid var(--menu-item-disabledColor);\n}\n.__menu__item[data-v-3d21bc0a]:not(.disabled):hover {\n  background: var(--menu-item-hoverBackground);\n}\n.__menu__item:not(.disabled):hover .__menu__item-icon[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverIconColor);\n}\n.__menu__item:not(.disabled):hover .__menu__item-label[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverLabelColor);\n}\n.__menu__item:not(.disabled):hover .__menu__item-tips[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverTipsColor);\n}\n.__menu__item:not(.disabled):hover .__menu__item-arrow[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverArrowColor);\n}\n.__menu__sub__item[data-v-3d21bc0a]:not(.disabled):hover {\n  background: var(--menu-item-hoverBackground);\n}\n.__menu__sub__item:not(.disabled):hover .__menu__sub__item-label[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverLabelColor);\n}\n.__menu__sub__item:not(.disabled):hover .__menu__sub__item-tips[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverTipsColor);\n}\n.__menu__item-icon[data-v-3d21bc0a] {\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  line-height: 20px;\n  margin-right: 4px;\n}\n.__menu__item-arrow.show .__menu__item-arrow-after[data-v-3d21bc0a] {\n  position: absolute;\n  width: 0;\n  height: 0;\n  left: 8px;\n  border-left: var(--menu-item-arrowRealSize) solid var(--menu-item-arrowColor);\n  border-top: var(--menu-item-arrowRealSize) solid transparent;\n  border-bottom: var(--menu-item-arrowRealSize) solid transparent;\n}\n.__menu__sub__wrapper[data-v-3d21bc0a] {\n  position: fixed;\n  visibility: hidden;\n  width: 200px;\n  background: var(--menu-background);\n  box-shadow: var(--menu-boxShadow);\n  padding: var(--menu-padding);\n  border-radius: var(--menu-borderRadius);\n}\n.__menu__item:hover .__menu__sub__wrapper[data-v-3d21bc0a] {\n  visibility: visible;\n}"),z.render=function(e,n,t,i,a,_){return o(),u(C,{to:"body",disabled:!e.appendToBody},[e.showMenu?(o(),r("div",{key:0,ref:"MenuWrapper",class:h(["__menu__wrapper",e.customClass]),style:x({width:`${e.menuWidth}px`,top:`${e.menuTop}px`,left:`${e.menuLeft}px`})},[(o(!0),r(d,null,s(e.calcMenuList,((n,t)=>(o(),r(d,null,[n.hidden||n.line?y("v-if",!0):(o(),r("div",l({key:t,class:["__menu__item",n.disabled&&"disabled",n.customClass]},{[c(e.clickEventKey)]:b((t=>e.handleMenuItemClick(n,t)),["stop"])},{onMouseenter:t=>e.handleMenuMouseEnter(t,n)}),[e.hasIcon?(o(),r("div",T,["font-icon"===e.iconType?v((o(),r("i",{key:0,class:h(n.icon)},null,2)),[[p,n.icon]]):"svg-icon"===e.iconType?v((o(),r("div",{key:1,class:"__menu__item-icon-svg",innerHTML:n.icon},null,8,I)),[[p,n.icon]]):"vnode-icon"===e.iconType?(o(),u(f(n.icon),{key:2})):y("v-if",!0)])):y("v-if",!0),g("span",F,w(n.label),1),g("span",j,w(n.tips||""),1),e.hasSubMenu?(o(),r("span",{key:1,class:h(["__menu__item-arrow",{show:e.hasSubMenu&&n.children}]),style:x({width:e.arrowSize+"px",height:e.arrowSize+"px"})},[v(g("span",W,null,512),[[p,e.hasSubMenu&&n.children]])],6)):y("v-if",!0),n.children&&n.children.length>0?v((o(),r("div",{key:2,class:"__menu__sub__wrapper",style:x({top:`${e.subTop}px`,left:`${e.subLeft}px`})},[(o(!0),r(d,null,s(n.children,((n,t)=>(o(),r(d,null,[n.hidden||n.line?y("v-if",!0):(o(),r("div",l({key:t,class:["__menu__sub__item",n.disabled&&"disabled",n.customClass]},{[c(e.clickEventKey)]:b((t=>e.handleSubMenuItemClick(n,t)),["stop"])}),[g("span",B,w(n.label),1),g("span",E,w(n.tips||""),1)],16)),n.line?(o(),r("div",{key:t,class:"__menu__line"})):y("v-if",!0)],64)))),256))],4)),[[p,e.hoverFlag]]):y("v-if",!0)],16,L)),!n.hidden&&n.line?(o(),r("div",{key:t,class:"__menu__line"})):y("v-if",!0)],64)))),256))],6)):y("v-if",!0)],8,["disabled"])},z.__scopeId="data-v-3d21bc0a",z.__file="packages/mouse-menu/mouse-menu.vue",z.install=e=>{e.component(z.name,z)};export{P as C};
