var e=Object.defineProperty,l=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,r=(l,t,a)=>t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[t]=a,n=(e,n)=>{for(var o in n||(n={}))t.call(n,o)&&r(e,o,n[o]);if(l)for(var o of l(n))a.call(n,o)&&r(e,o,n[o]);return e};import{S as o}from"./sortablejs-DhhifNSC.js";import{t as i}from"./index-B2iGRBN9.js";import{u}from"./epTheme-CJg-69CQ.js";import{g as s,C as d,_ as c,M as p}from"./@pureadmin-f9nW_l6N.js";import{E as v,R as f,C as m,D as b,S as x}from"./collapse-CfOj5F7d.js";import{d as y,r as h,M as g,b as w,s as C,m as k,F as j,i as T,P as E,a1 as O,E as R,D as S,Q as V,n as P}from"./@vue-CFXrvzpc.js";const B=p(y({name:"VxeTableBar",props:{title:{type:String,default:"列表"},vxeTableRef:{type:Object},columns:{type:Array,default:()=>[]},tree:{type:Boolean,default:!1},isExpandAll:{type:Boolean,default:!0},tableKey:{type:[String,Number],default:"0"}},emits:["refresh"],setup(e,{emit:l,slots:t,attrs:a}){const r=h("small"),p=h(!1),y=h(!0),B=h(!1),A=g(),$=h(e.isExpandAll);let D=s(d(null==e?void 0:e.columns),"title");const I=h(s(d(null==e?void 0:e.columns),"title")),K=h(d(null==e?void 0:e.columns)),M=w((()=>e=>({background:e===r.value?u().epThemeColor:"",color:e===r.value?"#fff":"var(--el-text-color-primary)"}))),_=w((()=>["text-black","dark:text-white","duration-100","hover:!text-primary","cursor-pointer","outline-none"])),z=w((()=>["flex","justify-between","pt-[3px]","px-[11px]","border-b-[1px]","border-solid","border-[#dcdfe6]","dark:border-[#303030]"]));function G(){const l=d(K.value).filter((e=>I.value.includes(e.title)));e.vxeTableRef.reloadColumn(l)}function N(){return l=this,t=null,a=function*(){y.value=!0,B.value=!1,K.value=d(null==e?void 0:e.columns),D=[],D=yield s(d(null==e?void 0:e.columns),"title"),I.value=s(d(null==e?void 0:e.columns),"title"),e.vxeTableRef.refreshColumn()},new Promise(((e,r)=>{var n=e=>{try{i(a.next(e))}catch(l){r(l)}},o=e=>{try{i(a.throw(e))}catch(l){r(l)}},i=l=>l.done?e(l.value):Promise.resolve(l.value).then(n,o);i((a=a.apply(l,t)).next())}));var l,t,a}function F(l){r.value=l,e.vxeTableRef.refreshColumn()}const Q={dropdown:()=>C(O("el-dropdown-menu"),{class:"translation"},{default:()=>[C(O("el-dropdown-item"),{style:M.value("medium"),onClick:()=>F("medium")},{default:()=>[R("宽松")]}),C(O("el-dropdown-item"),{style:M.value("small"),onClick:()=>F("small")},{default:()=>[R("默认")]}),C(O("el-dropdown-item"),{style:M.value("mini"),onClick:()=>F("mini")},{default:()=>[R("紧凑")]})]})},U=e=>({content:e,offset:[0,18],duration:[300,0],followCursor:!0,hideOnClick:"toggle"}),q={reference:()=>T(C(x,{class:["w-[16px]",_.value]},null),[[E("tippy"),U("列设置")]])};return()=>{let u;return C(j,null,[C("div",k(a,{class:"w-[99/100] mt-2 px-2 pb-2 bg-bg_color"}),[C("div",{class:"flex justify-between w-full h-[60px] p-4"},[(null==t?void 0:t.title)?t.title():C("p",{class:"font-bold truncate"},[e.title]),C("div",{class:"flex items-center justify-around"},[(null==t?void 0:t.buttons)?C("div",{class:"flex mr-4"},[t.buttons()]):null,e.tree?C(j,null,[T(C(v,{class:["w-[16px]",_.value],style:{transform:$.value?"none":"rotate(-90deg)"},onClick:()=>($.value=!$.value,$.value?e.vxeTableRef.setAllTreeExpand(!0):e.vxeTableRef.clearTreeExpand(),void e.vxeTableRef.refreshColumn())},null),[[E("tippy"),U($.value?"折叠":"展开")]]),C(O("el-divider"),{direction:"vertical"},null)]):null,T(C(f,{class:["w-[16px]",_.value,p.value?"animate-spin":""],onClick:()=>(p.value=!0,l("refresh"),void c(500).then((()=>p.value=!1)))},null),[[E("tippy"),U("刷新")]]),C(O("el-divider"),{direction:"vertical"},null),T(C(O("el-dropdown"),{trigger:"click"},n({default:()=>[C(m,{class:["w-[16px]",_.value]},null)]},Q)),[[E("tippy"),U("密度")]]),C(O("el-divider"),{direction:"vertical"},null),C(O("el-popover"),{placement:"bottom-start","popper-style":{padding:0},width:"200",trigger:"click"},n({default:()=>[C("div",{class:[z.value]},[C(O("el-checkbox"),{class:"!-mr-1",label:"列展示",modelValue:y.value,"onUpdate:modelValue":e=>y.value=e,indeterminate:B.value,onChange:e=>{return l=e,I.value=l?D:[],B.value=!1,void G();var l}},null),C(O("el-button"),{type:"primary",link:!0,onClick:()=>N()},{default:()=>[R("重置")]})]),C("div",{class:"pt-[6px] pl-[11px]"},[C(O("el-scrollbar"),{"max-height":"36vh"},{default:()=>[C(O("el-checkbox-group"),{ref:`VxeGroupRef${S(e.tableKey)}`,modelValue:I.value,onChange:e=>function(e){I.value=e;const l=e.length;y.value=l===D.length,B.value=l>0&&l<D.length}(e)},{default:()=>{return[C(O("el-space"),{direction:"vertical",alignment:"flex-start",size:0},(l=u=D.map(((l,t)=>{return C("div",{class:"flex items-center"},[C(b,{class:["drag-btn w-[16px] mr-2",(a=l,K.value.filter((e=>i(e.title)===i(a)))[0].fixed?"!cursor-no-drop":"!cursor-grab")],onMouseenter:l=>(l=>{l.preventDefault(),P((()=>{var l;const t=(null==(l=null==A?void 0:A.proxy)?void 0:l.$refs[`VxeGroupRef${S(e.tableKey)}`]).$el.firstElementChild;o.create(t,{animation:300,handle:".drag-btn",onEnd:({newIndex:e,oldIndex:l,item:t})=>{const a=t,r=a.parentNode,n=K.value[l],o=K.value[e];if((null==n?void 0:n.fixed)||(null==o?void 0:o.fixed)){const t=r.children[l];return void(e>l?r.insertBefore(a,t):r.insertBefore(a,t?t.nextElementSibling:t))}const i=K.value.splice(l,1)[0];K.value.splice(e,0,i),G()}})}))})(l)},null),C(O("el-checkbox"),{key:t,label:l,value:l,onChange:G},{default:()=>[C("span",{title:i(l),class:"inline-block w-[120px] truncate hover:text-text_color_primary"},[i(l)])]})]);var a})),"function"==typeof l||"[object Object]"===Object.prototype.toString.call(l)&&!V(l)?u:{default:()=>[u]}))];var l}})]})])]},q))])]),t.default({size:r.value,dynamicColumns:K.value})])])}}}));export{B as V};
