var e=Object.defineProperty,l=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(l,t,o)=>t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[t]=o,a=(e,a)=>{for(var u in a||(a={}))t.call(a,u)&&r(e,u,a[u]);if(l)for(var u of l(a))o.call(a,u)&&r(e,u,a[u]);return e};import{S as u}from"./sortable.esm-DhhifNSC.js";import{C as n,ad as i,z as d,r as c,t as s,Q as v,M as p}from"./index-DK9WUj9J.js";import{u as V}from"./epTheme-7UiBGgiM.js";import{E as f,R as m,C as b,D as h,S as x}from"./collapse-Bf6A8-db.js";const y={title:{type:String,default:"列表"},tableRef:{type:Object},columns:{type:Array,default:()=>[]},isExpandAll:{type:Boolean,default:!0},tableKey:{type:[String,Number],default:"0"}},g=p(Vue.defineComponent({name:"PureTableBar",props:y,emits:["refresh"],setup(e,{emit:l,slots:t,attrs:o}){const r=Vue.ref("default"),p=Vue.ref(!1),y=Vue.ref(!0),g=Vue.ref(!1),N=Vue.getCurrentInstance(),C=Vue.ref(e.isExpandAll),w=n(null==e?void 0:e.columns).filter((e=>i(null==e?void 0:e.hide)?!e.hide:!(d(null==e?void 0:e.hide)&&(null==e?void 0:e.hide()))));let k=c(n(null==e?void 0:e.columns),"label");const j=Vue.ref(c(n(w),"label")),D=Vue.ref(n(null==e?void 0:e.columns)),O=Vue.computed((()=>e=>({background:e===r.value?V().epThemeColor:"",color:e===r.value?"#fff":"var(--el-text-color-primary)"}))),E=Vue.computed((()=>["text-black","dark:text-white","duration-100","hover:!text-primary","cursor-pointer","outline-none"])),R=Vue.computed((()=>["flex","justify-between","pt-[3px]","px-[11px]","border-b-[1px]","border-solid","border-[#dcdfe6]","dark:border-[#303030]"]));function P(){C.value=!C.value,T(e.tableRef.data,C.value)}function T(l,t){l.forEach((l=>{e.tableRef.toggleRowExpansion(l,t),void 0!==l.children&&null!==l.children&&T(l.children,t)}))}function S(){return l=this,t=null,o=function*(){y.value=!0,g.value=!1,D.value=n(null==e?void 0:e.columns),k=[],k=yield c(n(null==e?void 0:e.columns),"label"),j.value=c(n(w),"label")},new Promise(((e,r)=>{var a=e=>{try{n(o.next(e))}catch(l){r(l)}},u=e=>{try{n(o.throw(e))}catch(l){r(l)}},n=l=>l.done?e(l.value):Promise.resolve(l.value).then(a,u);n((o=o.apply(l,t)).next())}));var l,t,o}const z={dropdown:()=>Vue.createVNode(Vue.resolveComponent("el-dropdown-menu"),{class:"translation"},{default:()=>[Vue.createVNode(Vue.resolveComponent("el-dropdown-item"),{style:O.value("large"),onClick:()=>r.value="large"},{default:()=>[Vue.createTextVNode("宽松")]}),Vue.createVNode(Vue.resolveComponent("el-dropdown-item"),{style:O.value("default"),onClick:()=>r.value="default"},{default:()=>[Vue.createTextVNode("默认")]}),Vue.createVNode(Vue.resolveComponent("el-dropdown-item"),{style:O.value("small"),onClick:()=>r.value="small"},{default:()=>[Vue.createTextVNode("紧凑")]})]})},A=e=>({content:e,offset:[0,18],duration:[300,0],followCursor:!0,hideOnClick:"toggle"}),B={reference:()=>Vue.withDirectives(Vue.createVNode(x,{class:["w-[16px]",E.value]},null),[[Vue.resolveDirective("tippy"),A("列设置")]])};return()=>{var n;let i;return Vue.createVNode(Vue.Fragment,null,[Vue.createVNode("div",Vue.mergeProps(o,{class:"w-[99/100] mt-2 px-2 pb-2 bg-bg_color"}),[Vue.createVNode("div",{class:"flex justify-between w-full h-[60px] p-4"},[(null==t?void 0:t.title)?t.title():Vue.createVNode("p",{class:"font-bold truncate"},[e.title]),Vue.createVNode("div",{class:"flex items-center justify-around"},[(null==t?void 0:t.buttons)?Vue.createVNode("div",{class:"flex mr-4"},[t.buttons()]):null,(null==(n=e.tableRef)?void 0:n.size)?Vue.createVNode(Vue.Fragment,null,[Vue.withDirectives(Vue.createVNode(f,{class:["w-[16px]",E.value],style:{transform:C.value?"none":"rotate(-90deg)"},onClick:()=>P()},null),[[Vue.resolveDirective("tippy"),A(C.value?"折叠":"展开")]]),Vue.createVNode(Vue.resolveComponent("el-divider"),{direction:"vertical"},null)]):null,Vue.withDirectives(Vue.createVNode(m,{class:["w-[16px]",E.value,p.value?"animate-spin":""],onClick:()=>(p.value=!0,l("refresh"),void v(500).then((()=>p.value=!1)))},null),[[Vue.resolveDirective("tippy"),A("刷新")]]),Vue.createVNode(Vue.resolveComponent("el-divider"),{direction:"vertical"},null),Vue.withDirectives(Vue.createVNode(Vue.resolveComponent("el-dropdown"),{trigger:"click"},a({default:()=>[Vue.createVNode(b,{class:["w-[16px]",E.value]},null)]},z)),[[Vue.resolveDirective("tippy"),A("密度")]]),Vue.createVNode(Vue.resolveComponent("el-divider"),{direction:"vertical"},null),Vue.createVNode(Vue.resolveComponent("el-popover"),{placement:"bottom-start","popper-style":{padding:0},width:"200",trigger:"click"},a({default:()=>[Vue.createVNode("div",{class:[R.value]},[Vue.createVNode(Vue.resolveComponent("el-checkbox"),{class:"!-mr-1",label:"列展示",modelValue:y.value,"onUpdate:modelValue":e=>y.value=e,indeterminate:g.value,onChange:e=>{return l=e,j.value=l?k:[],g.value=!1,void D.value.map((e=>e.hide=!l));var l}},null),Vue.createVNode(Vue.resolveComponent("el-button"),{type:"primary",link:!0,onClick:()=>S()},{default:()=>[Vue.createTextVNode("重置")]})]),Vue.createVNode("div",{class:"pt-[6px] pl-[11px]"},[Vue.createVNode(Vue.resolveComponent("el-scrollbar"),{"max-height":"36vh"},{default:()=>[Vue.createVNode(Vue.resolveComponent("el-checkbox-group"),{ref:`GroupRef${Vue.unref(e.tableKey)}`,modelValue:j.value,onChange:e=>function(e){j.value=e;const l=e.length;y.value=l===k.length,g.value=l>0&&l<k.length}(e)},{default:()=>{return[Vue.createVNode(Vue.resolveComponent("el-space"),{direction:"vertical",alignment:"flex-start",size:0},(l=i=k.map(((l,t)=>{return Vue.createVNode("div",{class:"flex items-center"},[Vue.createVNode(h,{class:["drag-btn w-[16px] mr-2",(o=l,D.value.filter((e=>s(e.label)===s(o)))[0].fixed?"!cursor-no-drop":"!cursor-grab")],onMouseenter:l=>(l=>{l.preventDefault(),Vue.nextTick((()=>{var l;const t=(null==(l=null==N?void 0:N.proxy)?void 0:l.$refs[`GroupRef${Vue.unref(e.tableKey)}`]).$el.firstElementChild;u.create(t,{animation:300,handle:".drag-btn",onEnd:({newIndex:e,oldIndex:l,item:t})=>{const o=t,r=o.parentNode,a=D.value[l],u=D.value[e];if((null==a?void 0:a.fixed)||(null==u?void 0:u.fixed)){const t=r.children[l];return void(e>l?r.insertBefore(o,t):r.insertBefore(o,t?t.nextElementSibling:t))}const n=D.value.splice(l,1)[0];D.value.splice(e,0,n)}})}))})(l)},null),Vue.createVNode(Vue.resolveComponent("el-checkbox"),{key:t,label:l,value:l,onChange:e=>function(e,l){D.value.filter((e=>s(e.label)===s(l)))[0].hide=!e}(e,l)},{default:()=>[Vue.createVNode("span",{title:s(l),class:"inline-block w-[120px] truncate hover:text-text_color_primary"},[s(l)])]})]);var o})),"function"==typeof l||"[object Object]"===Object.prototype.toString.call(l)&&!Vue.isVNode(l)?i:{default:()=>[i]}))];var l}})]})])]},B))])]),t.default({size:r.value,dynamicColumns:D.value})])])}}})),N={width:1024,height:1024,body:'<path fill="currentColor" d="M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"/>'};export{g as P,N as R};
