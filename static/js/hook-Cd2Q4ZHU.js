var e=(e,t,s)=>new Promise(((o,a)=>{var i=e=>{try{n(s.next(e))}catch(t){a(t)}},r=e=>{try{n(s.throw(e))}catch(t){a(t)}},n=e=>e.done?o(e.value):Promise.resolve(e.value).then(i,r);n((s=s.apply(e,t)).next())}));import{d as t}from"./dayjs-BWHVJBZs.js";import{_ as s}from"./form.vue_vue_type_script_setup_true_lang-C6Fhrr17.js";import{K as o,t as a,m as i,a as r}from"./index-B2iGRBN9.js";import{u as n}from"./hooks-1lxAD9ho.js";import{g as l,n as u}from"./@pureadmin-f9nW_l6N.js";import{h as p,i as m,j as c}from"./system-B7ZtQss2.js";import{aY as d}from"./element-plus-DsFyl0Kk.js";import{S as v,r as j,J as f,w as h,s as g,a1 as y,a6 as x,x as b}from"./@vue-CFXrvzpc.js";import"./@amap-Bx2D3lnM.js";import"./vite-plugin-fake-server-CytHVkXj.js";import"./@faker-js-CRy60TLX.js";import"./version-rocket-chvOQqaV.js";import"./@iconify-icons-CxRB8ffa.js";import"./@vueuse-tP1Y4vdd.js";import"./defu-iUM7Auia.js";import"./framesync-CUhBu5sQ.js";import"./style-value-types-UCYNu-x1.js";import"./popmotion-DRTv1-mp.js";import"./hey-listen-DkH12NBk.js";import"./plus-pro-components-CYEVFP0q.js";import"./sortablejs-DhhifNSC.js";import"./@element-plus-Bqpau_gV.js";import"./lodash-es-BgzC0s9P.js";import"./axios-B1L2Kzed.js";import"./vue-i18n-DB-7wkrF.js";import"./@intlify-DfwD9yJy.js";import"./js-cookie-BXEMiIsG.js";import"./pinia-DzAV29mk.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-CGx-uoKe.js";import"./axs-request-CnYniYE7.js";import"./nprogress-L6f6pfEY.js";import"./echarts-D2b6xzX-.js";import"./zrender-CUz1GrA9.js";import"./tslib-ZseNXxlj.js";import"./vxe-table-CPtn8uUL.js";import"./xe-utils-CdBoVBzI.js";import"./dom-zindex-Ckn4mXSH.js";import"./responsive-storage-5vfjqqcs.js";import"./vue-DWYrQbHy.js";import"./@iconify-BUzAfhQo.js";/* empty css                 */import"./vue-tippy-DPYCMIfw.js";import"./@popperjs-D3lHDW-0.js";import"./@ctrl-D2oWfImC.js";import"./async-validator-Cuo4gI4y.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-Vn5vHDCm.js";import"./@floating-ui-kghe82LF.js";function w(w){const k=v({name:"",code:"",status:""}),S=j(),z=j(),C=j([]),$=j([]),K=j([]),P=j(!1),T=j(!0),_=j(!1),M=j(),Y=j({}),D=j(!1),H=j(!1),{switchStyle:I}=n(),L=v({total:0,pageSize:10,currentPage:1,background:!0}),O=[{label:"角色编号",prop:"id"},{label:"角色名称",prop:"name"},{label:"角色标识",prop:"code"},{label:"状态",cellRenderer:e=>{var t;return g(y("el-switch"),{size:"small"===e.props.size?"small":"default",loading:null==(t=Y.value[e.index])?void 0:t.loading,modelValue:e.row.status,"onUpdate:modelValue":t=>e.row.status=t,"active-value":1,"inactive-value":0,"active-text":"已启用","inactive-text":"已停用","inline-prompt":!0,style:I.value,onChange:()=>function({row:e,index:t}){d.confirm(`确认要<strong>${0===e.status?"停用":"启用"}</strong><strong style='color:var(--el-color-primary)'>${e.name}</strong>吗?`,"系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,draggable:!0}).then((()=>{Y.value[t]=Object.assign({},Y.value[t],{loading:!0}),setTimeout((()=>{Y.value[t]=Object.assign({},Y.value[t],{loading:!1}),i(`已${0===e.status?"停用":"启用"}${e.name}`,{type:"success"})}),300)})).catch((()=>{0===e.status?e.status=1:e.status=0}))}(e)},null)},minWidth:90},{label:"备注",prop:"remark",minWidth:160},{label:"创建时间",prop:"createTime",minWidth:160,formatter:({createTime:e})=>t(e).format("YYYY-MM-DD HH:mm:ss")},{label:"操作",fixed:"right",width:210,slot:"operation"}];function R(){return e(this,null,(function*(){T.value=!0;const{data:e}=yield m(x(k));C.value=e.list,L.total=e.total,L.pageSize=e.pageSize,L.currentPage=e.currentPage,setTimeout((()=>{T.value=!1}),500)}))}return f((()=>e(this,null,(function*(){R();const{data:e}=yield p();$.value=l(e,"id"),K.value=o(e)})))),h(D,(e=>{e?w.value.setExpandedKeys($.value):w.value.setExpandedKeys([])})),h(H,(e=>{e?w.value.setCheckedKeys($.value):w.value.setCheckedKeys([])})),{form:k,isShow:P,curRow:S,loading:T,columns:O,rowStyle:function({row:{id:e}}){var t;return{cursor:"pointer",background:e===(null==(t=S.value)?void 0:t.id)?"var(--el-fill-color-light)":""}},dataList:C,treeData:K,treeProps:{value:"id",label:"title",children:"children"},isLinkage:_,pagination:L,isExpandAll:D,isSelectAll:H,treeSearchValue:M,onSearch:R,resetForm:e=>{e&&(e.resetFields(),R())},openDialog:function(e="新增",t){var o,a,n;r({title:`${e}角色`,props:{formInline:{name:null!=(o=null==t?void 0:t.name)?o:"",code:null!=(a=null==t?void 0:t.code)?a:"",remark:null!=(n=null==t?void 0:t.remark)?n:""}},width:"40%",draggable:!0,fullscreen:u(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>b(s,{ref:z}),beforeSure:(t,{options:s})=>{const o=z.value.getRef(),a=s.props.formInline;function r(){i(`您${e}了角色名称为${a.name}的这条数据`,{type:"success"}),t(),R()}o.validate((e=>{e&&r()}))}})},handleMenu:function(t){return e(this,null,(function*(){const{id:e}=t;if(e){S.value=t,P.value=!0;const{data:s}=yield c({id:e});w.value.setCheckedKeys(s)}else S.value=null,P.value=!1}))},handleSave:function(){const{id:e,name:t}=S.value;i(`角色名称为${t}的菜单权限修改成功`,{type:"success"})},handleDelete:function(e){i(`您删除了角色名称为${e.name}的这条数据`,{type:"success"}),R()},filterMethod:(e,t)=>a(t.title).includes(e),transformI18n:a,onQueryChanged:e=>{w.value.filter(e)},handleSizeChange:function(e){},handleCurrentChange:function(e){},handleSelectionChange:function(e){}}}export{w as useRole};
