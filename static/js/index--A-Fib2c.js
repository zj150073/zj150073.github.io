var t,e,i,s,n,r,l,o,a,u,h,c,d,f,p,m,y,b,g,v,P,T,w,C,S,E,q,I=Object.defineProperty,N=Object.defineProperties,x=Object.getOwnPropertyDescriptors,L=Object.getOwnPropertySymbols,D=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,M=t=>{throw TypeError(t)},A=(t,e,i)=>e in t?I(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,$=(t,e)=>{for(var i in e||(e={}))D.call(e,i)&&A(t,i,e[i]);if(L)for(var i of L(e))O.call(e,i)&&A(t,i,e[i]);return t},k=(t,e,i)=>A(t,"symbol"!=typeof e?e+"":e,i),j=(t,e,i)=>e.has(t)||M("Cannot "+i),z=(t,e,i)=>(j(t,e,"read from private field"),i?i.call(t):e.get(t)),H=(t,e,i)=>e.has(t)?M("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,i),F=(t,e,i)=>(j(t,e,"access private method"),i),R=(t,e,i)=>new Promise(((s,n)=>{var r=t=>{try{o(i.next(t))}catch(e){n(e)}},l=t=>{try{o(i.throw(t))}catch(e){n(e)}},o=t=>t.done?s(t.value):Promise.resolve(t.value).then(r,l);o((i=i.apply(t,e)).next())}));import{d as B,a as _,m as W,i as U}from"./index-CKXHolY4.js";const V=t=>Array.isArray(t),Q=t=>V(t)?t:[t];const J="data-typeit-id",X="ti-cursor",G={started:!1,completed:!1,frozen:!1,destroyed:!1},K={breakLines:!0,cursor:{autoPause:!0,autoPauseDelay:500,animation:{frames:[0,0,1].map((t=>({opacity:t}))),options:{iterations:1/0,easing:"steps(2, start)",fill:"forwards"}}},cursorChar:"|",cursorSpeed:1e3,deleteSpeed:null,html:!0,lifeLike:!0,loop:!1,loopDelay:750,nextStringDelay:750,speed:100,startDelay:250,startDelete:!1,strings:[],waitUntilVisible:!1,beforeString:()=>{},afterString:()=>{},beforeStep:()=>{},afterStep:()=>{},afterComplete:()=>{}},Y=`[${J}]:before {content: '.'; display: inline-block; width: 0; visibility: hidden;}`,Z=t=>document.createElement(t),tt=t=>document.createTextNode(t),et=(t,e="")=>{let i=Z("style");i.id=e,i.appendChild(tt(t)),document.head.appendChild(i)},it=t=>(V(t)||(t=[t/2,t/2]),t),st=(t,e)=>Math.abs(Math.random()*(t+e-(t-e))+(t-e));let nt=t=>t/2;const rt=t=>Array.from(t);let lt=t=>([...t.childNodes].forEach((t=>{if(t.nodeValue)return[...t.nodeValue].forEach((e=>{t.parentNode.insertBefore(tt(e),t)})),void t.remove();lt(t)})),t);const ot=t=>{let e=document.implementation.createHTMLDocument();return e.body.innerHTML=t,lt(e.body)};function at(t,e=!1,i=!1){let s,n=t.querySelector(`.${X}`),r=document.createTreeWalker(t,NodeFilter.SHOW_ALL,{acceptNode:t=>{var e,s;if(n&&i){if(null==(e=t.classList)?void 0:e.contains(X))return NodeFilter.FILTER_ACCEPT;if(n.contains(t))return NodeFilter.FILTER_REJECT}return(null==(s=t.classList)?void 0:s.contains(X))?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}}),l=[];for(;s=r.nextNode();)s.originalParent||(s.originalParent=s.parentNode),l.push(s);return e?l.reverse():l}function ut(t,e=!0){return e?at(ot(t)):rt(t).map(tt)}const ht=({index:t,newIndex:e,queueItems:i,cleanUp:s})=>{for(let n=t+1;n<e+1;n++)s(i[n][0])},ct=t=>Number.isInteger(t),dt=({queueItems:t,selector:e,cursorPosition:i,to:s})=>{if(ct(e))return-1*e;let n=new RegExp("END","i").test(s),r=e?[...t].reverse().findIndex((({char:t})=>{let i=t.parentElement,s=i.matches(e);return!(!n||!s)||s&&i.firstChild.isSameNode(t)})):-1;return r<0&&(r=n?0:t.length-1),r-i+(n?0:1)},ft=(t,e)=>new Array(e).fill(t);let pt=t=>new Promise((e=>{requestAnimationFrame((()=>R(void 0,null,(function*(){e(yield t())}))))})),mt=t=>null==t?void 0:t.getAnimations().find((e=>e.id===t.dataset.tiAnimationId)),yt=({cursor:t,frames:e,options:i})=>{let s=t.animate(e,i);return s.pause(),s.id=t.dataset.tiAnimationId,pt((()=>{pt((()=>{s.play()}))})),s},bt=t=>{var e;return null==(e=t.func)?void 0:e.call(null)},gt=t=>R(void 0,[t],(function*({index:t,queueItems:e,wait:i,cursor:s,cursorOptions:n}){let r=e[t][1],l=[],o=t,a=r,u=()=>a&&!a.delay,h=r.shouldPauseCursor()&&n.autoPause;for(;u();)l.push(a),u()&&o++,a=e[o]?e[o][1]:null;if(l.length)return yield pt((()=>R(void 0,null,(function*(){for(let t of l)yield bt(t)})))),o-1;let c,d=mt(s);var f,p;return d&&(f=$({},d.effect.getComputedTiming()),p={delay:h?n.autoPauseDelay:0},c=N(f,x(p))),yield i((()=>R(void 0,null,(function*(){d&&h&&d.cancel(),yield pt((()=>{bt(r)}))}))),r.delay),yield(({cursor:t,options:e,cursorOptions:i})=>{if(!t||!i)return;let s,n=mt(t);n&&(e.delay=n.effect.getComputedTiming().delay,s=n.currentTime,n.cancel());let r=yt({cursor:t,frames:i.animation.frames,options:e});return s&&(r.currentTime=s),r})({cursor:s,options:c,cursorOptions:n}),t}));const vt=t=>"value"in t;let Pt=t=>"function"==typeof t?t():t,Tt=(t,e=document,i=!1)=>e["querySelector"+(i?"All":"")](t);const wt=(t,e)=>Object.assign({},t,e);let Ct={"font-family":"","font-weight":"","font-size":"","font-style":"","line-height":"",color:"",transform:"translateX(-.125em)"};let St=(q=class{constructor(e,i={}){var s;H(this,t),k(this,"element"),k(this,"timeouts"),k(this,"cursorPosition"),k(this,"predictedCursorPosition"),k(this,"statuses",{started:!1,completed:!1,frozen:!1,destroyed:!1}),k(this,"opts"),k(this,"id"),k(this,"queue"),k(this,"cursor"),k(this,"unfreeze",(()=>{})),k(this,"is",(function(t){return this.statuses[t]})),H(this,p,(e=>{var i;e.cursor=(t=>{var e,i,s;if("object"==typeof t){let n={},{frames:r,options:l}=K.cursor.animation;return n.animation=t.animation||{},n.animation.frames=(null==(e=t.animation)?void 0:e.frames)||r,n.animation.options=wt(l,(null==(i=t.animation)?void 0:i.options)||{}),n.autoPause=null!=(s=t.autoPause)?s:K.cursor.autoPause,n.autoPauseDelay=t.autoPauseDelay||K.cursor.autoPauseDelay,n}return!0===t?K.cursor:t})(null!=(i=e.cursor)?i:K.cursor),this.opts.strings=F(this,t,m).call(this,Q(this.opts.strings)),this.opts=wt(this.opts,{html:!z(this,t,C)&&this.opts.html,nextStringDelay:it(this.opts.nextStringDelay),loopDelay:it(this.opts.loopDelay)})})),this.opts=wt(K,i),this.element="string"==typeof(s=e)?Tt(s):s,this.timeouts=[],this.cursorPosition=0,this.unfreeze=()=>{},this.predictedCursorPosition=null,this.statuses=wt({},G),this.id=Math.random().toString().substring(2,9),this.queue=function(t){let e=function(t){return Q(t).forEach((t=>{var e;return n.set(Symbol(null==(e=t.char)?void 0:e.innerText),i($({},t)))})),this},i=t=>(t.shouldPauseCursor=function(){return Boolean(this.typeable||this.cursorable||this.deletable)},t),s=()=>Array.from(n.values()),n=new Map;return e(t),{add:e,set:function(t,e){let s=[...n.keys()];n.set(s[t],i(e))},wipe:function(){n=new Map,e(t)},done:(t,e=!1)=>e?n.delete(t):n.get(t).done=!0,reset:function(){n.forEach((t=>delete t.done))},destroy:t=>n.delete(t),getItems:(t=!1)=>t?s():s().filter((t=>!t.done)),getQueue:()=>n,getTypeable:()=>s().filter((t=>t.typeable))}}([{delay:this.opts.startDelay}]),z(this,p).call(this,i),this.cursor=F(this,t,y).call(this),this.element.dataset.typeitId=this.id,et(Y),this.opts.strings.length&&F(this,t,f).call(this)}go(){return this.statuses.started?this:(F(this,t,o).call(this),this.opts.waitUntilVisible?(e=this.element,s=F(this,t,i).bind(this),new IntersectionObserver(((t,i)=>{t.forEach((t=>{t.isIntersecting&&(s(),i.unobserve(e))}))}),{threshold:1}).observe(e),this):(F(this,t,i).call(this),this));var e,s}destroy(e=!0){this.timeouts=(this.timeouts.forEach(clearTimeout),[]),Pt(e)&&this.cursor&&F(this,t,P).call(this,this.cursor),this.statuses.destroyed=!0}reset(e){!this.is("destroyed")&&this.destroy(),e?(this.queue.wipe(),e(this)):this.queue.reset(),this.cursorPosition=0;for(let t in this.statuses)this.statuses[t]=!1;return this.element[F(this,t,a).call(this)?"value":"innerHTML"]="",this}type(e,i={}){e=Pt(e);let{instant:s}=i,n=F(this,t,c).call(this,i),r=ut(e,this.opts.html).map((e=>{return{func:()=>F(this,t,g).call(this,e),char:e,delay:s||(i=e,/<(.+)>(.*?)<\/(.+)>/.test(i.outerHTML))?0:F(this,t,T).call(this),typeable:e.nodeType===Node.TEXT_NODE};var i})),l=[n[0],{func:()=>R(this,null,(function*(){return yield this.opts.beforeString(e,this)}))},...r,{func:()=>R(this,null,(function*(){return yield this.opts.afterString(e,this)}))},n[1]];return F(this,t,u).call(this,l,i)}break(e={}){return F(this,t,u).call(this,{func:()=>F(this,t,g).call(this,Z("BR")),typeable:!0},e)}move(e,i={}){e=Pt(e);let n=F(this,t,c).call(this,i),{instant:r,to:l}=i,o=dt({queueItems:this.queue.getTypeable(),selector:null===e?"":e,to:l,cursorPosition:z(this,t,w)}),a=o<0?-1:1;return this.predictedCursorPosition=z(this,t,w)+o,F(this,t,u).call(this,[n[0],...ft({func:()=>F(this,t,s).call(this,a),delay:r?0:F(this,t,T).call(this),cursorable:!0},Math.abs(o)),n[1]],i)}exec(e,i={}){let s=F(this,t,c).call(this,i);return F(this,t,u).call(this,[s[0],{func:()=>e(this)},s[1]],i)}options(e,i={}){return e=Pt(e),F(this,t,d).call(this,e),F(this,t,u).call(this,{},i)}pause(e,i={}){return F(this,t,u).call(this,{delay:Pt(e)},i)}delete(e=null,i={}){e=Pt(e);let s=F(this,t,c).call(this,i),n=e,{instant:r,to:l}=i,o=this.queue.getTypeable(),a=(()=>null===n?o.length:ct(n)?n:dt({queueItems:o,selector:n,cursorPosition:z(this,t,w),to:l}))();return F(this,t,u).call(this,[s[0],...ft({func:F(this,t,v).bind(this),delay:r?0:F(this,t,T).call(this,1),deletable:!0},a),s[1]],i)}freeze(){this.statuses.frozen=!0}flush(e=()=>{}){return F(this,t,o).call(this),F(this,t,i).call(this,!1).then(e),this}getQueue(){return this.queue}getOptions(){return this.opts}updateOptions(e){return F(this,t,d).call(this,e)}getElement(){return this.element}empty(i={}){return F(this,t,u).call(this,{func:F(this,t,e).bind(this)},i)}},t=new WeakSet,e=function(){return R(this,null,(function*(){F(this,t,a).call(this)?this.element.value="":z(this,t,E).forEach(F(this,t,P).bind(this))}))},i=function(e=!0){return R(this,null,(function*(){this.statuses.started=!0;let s=t=>{this.queue.done(t,!e)};try{let o=[...this.queue.getQueue()];for(let e=0;e<o.length;e++){let[i,n]=o[e];if(!n.done){if(!n.deletable||n.deletable&&z(this,t,E).length){let i=yield F(this,t,r).call(this,e,o);ht({index:e,newIndex:i,queueItems:o,cleanUp:s}),e=i}s(i)}}if(!e)return this;if(this.statuses.completed=!0,yield this.opts.afterComplete(this),!this.opts.loop)throw"";let a=this.opts.loopDelay;F(this,t,l).call(this,(()=>R(this,null,(function*(){yield F(this,t,n).call(this,a[0]),F(this,t,i).call(this)}))),a[1])}catch(o){}return this}))},s=function(e){return R(this,null,(function*(){var i,s,n;this.cursorPosition=(i=e,s=this.cursorPosition,n=z(this,t,E),Math.min(Math.max(s+i,0),n.length)),((t,e,i)=>{let s=e[i-1],n=Tt(`.${X}`,t);(t=(null==s?void 0:s.parentNode)||t).insertBefore(n,s||null)})(this.element,z(this,t,E),this.cursorPosition)}))},n=function(e){return R(this,null,(function*(){let i=z(this,t,w);i&&(yield F(this,t,s).call(this,{value:i}));let n=z(this,t,E).map((e=>[Symbol(),{func:F(this,t,v).bind(this),delay:F(this,t,T).call(this,1),deletable:!0,shouldPauseCursor:()=>!0}]));for(let e=0;e<n.length;e++)yield F(this,t,r).call(this,e,n);this.queue.reset(),this.queue.set(0,{delay:e})}))},r=function(e,i){return gt({index:e,queueItems:i,wait:F(this,t,l).bind(this),cursor:this.cursor,cursorOptions:this.opts.cursor})},l=function(t,e,i=!1){return R(this,null,(function*(){this.statuses.frozen&&(yield new Promise((t=>{this.unfreeze=()=>{this.statuses.frozen=!1,t()}}))),i||(yield this.opts.beforeStep(this)),yield((t,e,i)=>new Promise((s=>{i.push(setTimeout((()=>R(void 0,null,(function*(){yield t(),s()}))),e||0))})))(t,e,this.timeouts),i||(yield this.opts.afterStep(this))}))},o=function(){return R(this,null,(function*(){if(!F(this,t,a).call(this)&&this.cursor&&this.element.appendChild(this.cursor),z(this,t,S)){((t,e)=>{let i=`[${J}='${t}'] .${X}`,s=getComputedStyle(e),n=Object.entries(Ct).reduce(((t,[e,i])=>`${t} ${e}: var(--ti-cursor-${e}, ${i||s[e]});`),"");et(`${i} { display: inline-block; width: 0; ${n} }`,t)})(this.id,this.element),this.cursor.dataset.tiAnimationId=this.id;let{animation:t}=this.opts.cursor,{frames:e,options:i}=t;yt({frames:e,cursor:this.cursor,options:$({duration:this.opts.cursorSpeed},i)})}}))},a=function(){return vt(this.element)},u=function(e,i){return this.queue.add(e),F(this,t,h).call(this,i),this},h=function(t={}){let e=t.delay;e&&this.queue.add({delay:e})},c=function(e={}){return[{func:()=>F(this,t,d).call(this,e)},{func:()=>F(this,t,d).call(this,this.opts)}]},d=function(t){return R(this,null,(function*(){this.opts=wt(this.opts,t)}))},f=function(){let e=this.opts.strings.filter((t=>!!t));e.forEach(((i,s)=>{if(this.type(i),s+1===e.length)return;let n=this.opts.breakLines?[{func:()=>F(this,t,g).call(this,Z("BR")),typeable:!0}]:ft({func:F(this,t,v).bind(this),delay:F(this,t,T).call(this,1)},this.queue.getTypeable().length);F(this,t,b).call(this,n)}))},p=new WeakMap,m=function(e){let i=this.element.innerHTML;return i?(this.element.innerHTML="",this.opts.startDelete?(this.element.innerHTML=i,lt(this.element),F(this,t,b).call(this,ft({func:F(this,t,v).bind(this),delay:F(this,t,T).call(this,1),deletable:!0},z(this,t,E).length)),e):(s=i,s.replace(/<!--(.+?)-->/g,"").trim().split(/<br(?:\s*?)(?:\/)?>/)).concat(e)):e;var s},y=function(){if(z(this,t,C))return null;let e=Z("span");return e.className=X,z(this,t,S)?(e.innerHTML=ot(this.opts.cursorChar).innerHTML,e):(e.style.visibility="hidden",e)},b=function(t){let e=this.opts.nextStringDelay;this.queue.add([{delay:e[0]},...t,{delay:e[1]}])},g=function(t){((t,e)=>{if(vt(t))return void(t.value=`${t.value}${e.textContent}`);e.innerHTML="";let i=(s=e.originalParent,/body/i.test(null==s?void 0:s.tagName)?t:e.originalParent||t);var s;i.insertBefore(e,Tt("."+X,i)||null)})(this.element,t)},v=function(){z(this,t,E).length&&(z(this,t,C)?this.element.value=this.element.value.slice(0,-1):F(this,t,P).call(this,z(this,t,E)[this.cursorPosition]))},P=function(t){((t,e)=>{if(!t)return;let i=t.parentNode;(i.childNodes.length>1||i.isSameNode(e)?t:i).remove()})(t,this.element)},T=function(t=0){return function(t){let{speed:e,deleteSpeed:i,lifeLike:s}=t;return i=null!==i?i:e/3,s?[st(e,nt(e)),st(i,nt(i))]:[e,i]}(this.opts)[t]},w=function(){var t;return null!=(t=this.predictedCursorPosition)?t:this.cursorPosition},C=function(){return vt(this.element)},S=function(){return!!this.opts.cursor&&!z(this,t,C)},E=function(){return t=this.element,vt(t)?rt(t.value):at(t,!0).filter((t=>!(t.childNodes.length>0)));var t},q);const Et=B({name:"TypeIt",props:{options:{type:Object,default:()=>({})}},setup(t,{slots:e,expose:i}){const s=_(null);return W((()=>{const e=s.value.querySelector(".type-it");if(!e){!function(t){throw new TypeError(t)}("zh-CN"===navigator.language?"请确保有且只有一个具有class属性为 'type-it' 的元素":"Please make sure that there is only one element with a Class attribute with 'type-it'")}const n=new St(e,t.options).go();i({typeIt:n})})),()=>{var t,i;return U("div",{ref:s},[null!=(i=null==(t=e.default)?void 0:t.call(e))?i:U("span",{class:"type-it"},null)])}}});export{Et as T};
