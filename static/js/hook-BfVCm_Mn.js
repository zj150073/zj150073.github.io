import{_ as e}from"./form.vue_vue_type_script_setup_true_lang-Dn9nA08F.js";import{Z as t,aI as l,l as n,C as a,f as r,m as o}from"./index-DK9WUj9J.js";import{e as s}from"./system-CZHEA98f.js";import{u as i}from"./hooks-siYFZ-vN.js";import"./index-C3WTS9yW.js";function u(){const u=Vue.reactive({name:"",status:null}),m=Vue.ref(),p=Vue.ref([]),d=Vue.ref(!0),{tagStyle:c}=i(),f=[{label:"部门名称",prop:"name",width:180,align:"left"},{label:"排序",prop:"sort",minWidth:70},{label:"状态",prop:"status",minWidth:100,cellRenderer:({row:e,props:t})=>Vue.createVNode(Vue.resolveComponent("el-tag"),{size:t.size,style:c.value(e.status)},{default:()=>[1===e.status?"启用":"停用"]})},{label:"创建时间",minWidth:200,prop:"createTime",formatter:({createTime:e})=>dayjs(e).format("YYYY-MM-DD HH:mm:ss")},{label:"备注",prop:"remark",minWidth:320},{label:"操作",fixed:"right",width:210,slot:"operation"}];function h(){return e=this,n=null,a=function*(){d.value=!0;const{data:e}=yield s();let n=e;t(u.name)||(n=n.filter((e=>e.name.includes(u.name)))),t(u.status)||(n=n.filter((e=>e.status===u.status))),p.value=l(n),setTimeout((()=>{d.value=!1}),500)},new Promise(((t,l)=>{var r=e=>{try{s(a.next(e))}catch(t){l(t)}},o=e=>{try{s(a.throw(e))}catch(t){l(t)}},s=e=>e.done?t(e.value):Promise.resolve(e.value).then(r,o);s((a=a.apply(e,n)).next())}));var e,n,a}function v(e){if(!e||!e.length)return;const t=[];for(let l=0;l<e.length;l++)e[l].disabled=0===e[l].status,v(e[l].children),t.push(e[l]);return t}return Vue.onMounted((()=>{h()})),{form:u,loading:d,columns:f,dataList:p,onSearch:h,resetForm:function(e){e&&(e.resetFields(),h())},openDialog:function(t="新增",l){var s,i,u,d,c,f,g,y;n({title:`${t}部门`,props:{formInline:{higherDeptOptions:v(a(p.value)),parentId:null!=(s=null==l?void 0:l.parentId)?s:0,name:null!=(i=null==l?void 0:l.name)?i:"",principal:null!=(u=null==l?void 0:l.principal)?u:"",phone:null!=(d=null==l?void 0:l.phone)?d:"",email:null!=(c=null==l?void 0:l.email)?c:"",sort:null!=(f=null==l?void 0:l.sort)?f:0,status:null!=(g=null==l?void 0:l.status)?g:1,remark:null!=(y=null==l?void 0:l.remark)?y:""}},width:"40%",draggable:!0,fullscreen:r(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>Vue.h(e,{ref:m}),beforeSure:(e,{options:l})=>{const n=m.value.getRef(),a=l.props.formInline;function r(){o(`您${t}了部门名称为${a.name}的这条数据`,{type:"success"}),e(),h()}n.validate((e=>{e&&r()}))}})},handleDelete:function(e){o(`您删除了部门名称为${e.name}的这条数据`,{type:"success"}),h()},handleSelectionChange:function(e){}}}export{u as useDept};
