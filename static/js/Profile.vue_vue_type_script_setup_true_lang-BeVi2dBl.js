var e=Object.defineProperty,l=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,u=(l,t,o)=>t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[t]=o;import{f as n}from"./mock-BfijETem.js";import{aC as c,f as i,K as V,m as s}from"./index-DK9WUj9J.js";import{R as d}from"./index-BkuuDSTU.js";import{d as m}from"./upload-line-D6XAvwvG.js";const p=Vue.createElementVNode("h3",{class:"my-8"},"个人信息",-1),f=Vue.createElementVNode("span",{class:"ml-2"},"更新头像",-1),v={class:"dialog-footer"},h=Vue.defineComponent((w=((e,l)=>{for(var t in l||(l={}))a.call(l,t)&&u(e,t,l[t]);if(o)for(var t of o(l))r.call(l,t)&&u(e,t,l[t]);return e})({},{name:"Profile"}),l(w,t({__name:"Profile",setup(e){const l=Vue.ref(""),t=Vue.ref(),o=Vue.ref(),a=Vue.ref(),r=Vue.ref(!1),u=Vue.ref(),h=Vue.reactive({avatar:"",nickname:"",email:"",phone:"",description:""}),w=Vue.reactive({nickname:[{required:!0,message:"昵称必填",trigger:"blur"}]});function C(e,l){let t=[],o=[];[{value:"@qq.com"},{value:"@126.com"},{value:"@163.com"}].map((l=>o.push({value:e.split("@")[0]+l.value}))),t=e?o.filter((l=>0===l.value.toLowerCase().indexOf(e.toLowerCase()))):o,l(t)}const x=e=>{const t=new FileReader;t.onload=e=>{l.value=e.target.result,r.value=!0},t.readAsDataURL(e.raw)},b=()=>{o.value.hidePopover(),a.value.clearFiles(),r.value=!1},y=({blob:e})=>t.value=e,N=()=>{const e=V({files:new File([t.value],"avatar")});n(e).then((({success:e,data:l})=>{e?(s("更新头像成功",{type:"success"}),b()):s("更新头像失败")})).catch((e=>{s(`提交异常 ${e}`,{type:"error"})}))},g=e=>{return l=this,t=null,o=function*(){yield e.validate(((e,l)=>{e&&s("更新信息成功",{type:"success"})}))},new Promise(((e,a)=>{var r=e=>{try{n(o.next(e))}catch(l){a(l)}},u=e=>{try{n(o.throw(e))}catch(l){a(l)}},n=l=>l.done?e(l.value):Promise.resolve(l.value).then(r,u);n((o=o.apply(l,t)).next())}));var l,t,o};return c().then((e=>{Object.assign(h,e.data)})),(e,t)=>{const n=Vue.resolveComponent("el-avatar"),c=Vue.resolveComponent("IconifyIconOffline"),V=Vue.resolveComponent("el-button"),s=Vue.resolveComponent("el-upload"),_=Vue.resolveComponent("el-form-item"),k=Vue.resolveComponent("el-input"),O=Vue.resolveComponent("el-autocomplete"),j=Vue.resolveComponent("el-form"),P=Vue.resolveComponent("el-dialog");return Vue.openBlock(),Vue.createElementBlock("div",{class:Vue.normalizeClass(["min-w-[180px]",Vue.unref(i)()?"max-w-[100%]":"max-w-[70%]"])},[p,Vue.createVNode(j,{ref_key:"userInfoFormRef",ref:u,"label-position":"top",rules:w,model:h},{default:Vue.withCtx((()=>[Vue.createVNode(_,{label:"头像"},{default:Vue.withCtx((()=>[Vue.createVNode(n,{size:80,src:h.avatar},null,8,["src"]),Vue.createVNode(s,{ref_key:"uploadRef",ref:a,accept:"image/*",action:"#",limit:1,"auto-upload":!1,"show-file-list":!1,"on-change":x},{default:Vue.withCtx((()=>[Vue.createVNode(V,{plain:"",class:"ml-4"},{default:Vue.withCtx((()=>[Vue.createVNode(c,{icon:Vue.unref(m)},null,8,["icon"]),f])),_:1})])),_:1},512)])),_:1}),Vue.createVNode(_,{label:"昵称",prop:"nickname"},{default:Vue.withCtx((()=>[Vue.createVNode(k,{modelValue:h.nickname,"onUpdate:modelValue":t[0]||(t[0]=e=>h.nickname=e),placeholder:"请输入昵称"},null,8,["modelValue"])])),_:1}),Vue.createVNode(_,{label:"邮箱",prop:"email"},{default:Vue.withCtx((()=>[Vue.createVNode(O,{modelValue:h.email,"onUpdate:modelValue":t[1]||(t[1]=e=>h.email=e),"fetch-suggestions":C,"trigger-on-focus":!1,placeholder:"请输入邮箱",clearable:"",class:"w-full"},null,8,["modelValue"])])),_:1}),Vue.createVNode(_,{label:"联系电话"},{default:Vue.withCtx((()=>[Vue.createVNode(k,{modelValue:h.phone,"onUpdate:modelValue":t[2]||(t[2]=e=>h.phone=e),placeholder:"请输入联系电话",clearable:""},null,8,["modelValue"])])),_:1}),Vue.createVNode(_,{label:"简介"},{default:Vue.withCtx((()=>[Vue.createVNode(k,{modelValue:h.description,"onUpdate:modelValue":t[3]||(t[3]=e=>h.description=e),placeholder:"请输入简介",type:"textarea",autosize:{minRows:6,maxRows:8},maxlength:"56","show-word-limit":""},null,8,["modelValue"])])),_:1}),Vue.createVNode(V,{type:"primary",onClick:t[4]||(t[4]=e=>g(u.value))},{default:Vue.withCtx((()=>[Vue.createTextVNode(" 更新信息 ")])),_:1})])),_:1},8,["rules","model"]),Vue.createVNode(P,{modelValue:r.value,"onUpdate:modelValue":t[5]||(t[5]=e=>r.value=e),width:"40%",title:"编辑头像","destroy-on-close":"",closeOnClickModal:!1,"before-close":b,fullscreen:Vue.unref(i)()},{footer:Vue.withCtx((()=>[Vue.createElementVNode("div",v,[Vue.createVNode(V,{bg:"",text:"",onClick:b},{default:Vue.withCtx((()=>[Vue.createTextVNode("取消")])),_:1}),Vue.createVNode(V,{bg:"",text:"",type:"primary",onClick:N},{default:Vue.withCtx((()=>[Vue.createTextVNode(" 确定 ")])),_:1})])])),default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(d),{ref_key:"cropRef",ref:o,imgSrc:l.value,onCropper:y},null,8,["imgSrc"])])),_:1},8,["modelValue","fullscreen"])],2)}}}))));var w;export{h as _};
