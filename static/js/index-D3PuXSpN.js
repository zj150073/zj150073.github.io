var e=Object.defineProperty,a=Object.defineProperties,A=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(a,A,t)=>A in a?e(a,A,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[A]=t;import{k as u,g as o,v as i,S as d,d as r,a as c,p as m,r as p,m as f,z as v,f as h,a4 as g,N as E,y as B,o as C,b as y,w as Q,e as w,h as k,i as I,t as x,a5 as b,u as M,a6 as S,_ as D}from"./index-Doj-dlYt.js";const R=[{avatar:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIADIAMgMBIgACEQEDEQH/xAAbAAEAAgMBAQAAAAAAAAAAAAAFBAYBAgMAB//aAAgBAQAAAAD7HU4ObhMC3AnlYvY8ISwA+6WDOd4/RA96FVeF66BOVWB3TsAOgZC27wv/xAAYAQEBAQEBAAAAAAAAAAAAAAACAwQAAf/aAAgBAhAAAAC3sw8uyRDQPV//xAAYAQADAQEAAAAAAAAAAAAAAAAAAgMBBP/aAAgBAxAAAACQ7LfmoUTNvFf/xAA0EAACAQMBBAcHAwUAAAAAAAABAgMABBESBRMxQRAhIjJRYbEUIzRCUnOBM3KSU2KRoeH/2gAIAQEAAT8AmmSCJpHOAoq6vZp8lmITkgonSQCMZxikkdGDxsVbxFbK2l7TGUkwHQfy6Ln4if7jetbcdglvH9TFv40hD71CGzlQpAyACRkt4VcxojxOdIj06GzwA5VKkilGUdjUcNxD9XlwI5g1Bfm0u4nC5UHDeYNWu0LS4B3D6mHHIwaufiJ/uN61tm6Et6GPCIbv8mtqi4gtrFkzjeuxIGRq+TP4orI1jpK+8MHAfVprYcM8kVysmoIGiwG8UfVgVcwh1ecDGiYcvlNWk7W9zDKucqwyPEVOczzfvb1q/wBkXWqR4Sja8nDHGCajAEagHIAx/jourmK0haaV9KrWyrFZLRZJ07MqNhc8Q3M/irfZFlaOGQF2HzOc1cACeYD+o3r0XptYEJKAyMx06TgsxOaupr+MhkIQk6TlfPlkVNCIxBc3A9onLjRG/WtWV1BPFlRp09TpzBHLoufiJ/uN69G05JLxt8C2ksQpTiAMHIq0mQz6HnMnZwurBwBRhKTLLK5Y6Oz/AGf9qwla3u4TykBRh/sdFx8RN9xvWpri43Unv5O6fmNSSSCHGtsb0DGfKrFm3zdZ7o9RUskhMnbbu+NLJJrh7bfqJz869onxjfSY/callk3knvG7x51//8QAIxEAAgEEAQMFAAAAAAAAAAAAAQIRAAMSMRAEIXETMjNBUf/aAAgBAgEBPwBMUTNv3tSdQrgZDYpwMmx0N8PdFv0iBMAyKS4QroF99JcxDhhMntwxgUCoJIER90jZCeG2PBpvjNWtHzx//8QAIBEAAgICAgIDAAAAAAAAAAAAAQIAERASAyEyM0GBkf/aAAgBAwEBPwBtmbURuErdRb1W/nCIW3vqMgJVr8YyWVIyvYG/5CKwJze36jY//9k=",name:"美绪",text:"马什么梅？"},{avatar:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIADIAMgMBIgACEQEDEQH/xAAbAAACAwEBAQAAAAAAAAAAAAAABQIDBAEGB//aAAgBAQAAAAD65hzG3WLcATfCbHYQ9IY0uiEfRkU1IOr+RoUG1ornWj7Y6//EABgBAQADAQAAAAAAAAAAAAAAAAQAAgUD/9oACAECEAAAACEf3IJba51tGDNq/wD/xAAYAQEAAwEAAAAAAAAAAAAAAAAEAQMFAv/aAAgBAxAAAABSg0MWQdj+c6VozP/EAC0QAAIBAwMBBgUFAAAAAAAAAAECEQADBBASMUEiUVJhcZEFExQhgSAyQoKx/9oACAEBAAE/AKu5oEi2A3meKOXf8cfgV9Xe2kEgyOeCKsZSXAqs0XP91z7+wC3MSCzeg/RbuG06uO8T6a5kNkOOu0CpUXWQMdo4kQRPQihPd9tH+4jXIw0yDukq0RNHFu2/iOVku0pfx7foHt91MttbMyN7njqQDo3BPkdWEqRJEjkV8QOV2LVq2xBBlkoq+y181CrgHn1nXHffZQ+UH8aEwCaEoJP9qzbe+ySOUO7XCuxca2f5CR6jS477H7bftPWt7+NvekdzbWXYyo60rvtXtHgda3v4j71Yd/qLPaPJ6+Vb38be9f/EACYRAAECBAQHAQAAAAAAAAAAAAECAwAEEBIREzFSITNBQlFhgXL/2gAIAQIBAT8AffKDYjXqYznd5hhwuI46ijjOOaSfaYUm232Ik9F/KKQFRMN2LHgiJVdrmG6s32fYa5iP0Kf/xAAmEQABAgQFBAMAAAAAAAAAAAABAgMAEBESBBNCUoEhMTNhUXFy/9oACAEDAQE/AGGAoXK4EZLWwQ+2G19Oxk28RlhI9GEqur9xi9HMm3C2qtAfRhhy9J+axiUXIrtnhdfEOeNf5Mv/2Q==",name:"博士",text:"马东什么？"},{avatar:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIADIAMgMBIgACEQEDEQH/xAAxAAACAgMBAAAAAAAAAAAAAAAABgQFAQIHAwEBAAMBAAAAAAAAAAAAAAAAAwABAgT/2gAMAwEAAhADEAAAAI7CsPnN1VeZ0okpTbSWASKzwmMPRy3PuuWhpv4KvQ7pcJYTUb+hdLQYWJoaVU+RU3jcXiaoegAhWOAPeeaBd1wGtf/EAC4QAAIBAwIEBAUFAQAAAAAAAAECAwAEEQUhBhASMRMiQWEUI3KBoSAzQlFSkv/aAAgBAQABPwDTxidHHbdTyZGjdkcYYelBGKM4HlUgH7/osXInRfQsK0q18abxGHkj/JrV0KXrEfzUGtLiE0F1G48r4GfcVJDJFI0TbMp52W91D9VXt42mWQCu0QUqHZQC7SyDIRA22QO5NXkFyLeFpnWRggYsMZw/+ioAPsRVlOtrpsshx+6d2OFGw3J/oVK897YR6nbfORCTkp0OVQ7lRk5Aq5gMZSVR8qVepfbPpy0jDSRyEZxIg/6JrjKJytlEEJ63uJD7ttXB6Tn41bhW8Mwxxjqzt3OBWrx+Bw9fQsRvIgBzjYutcP3F8upWVmZZltvjFPQW22BqeAJpHh+kWyeyhsL+KXS9RcB1WLpYZGSc4NcKwxTrcRy+qrj2IJIqe3S5AEsSOAcgMobB+9Lb9KhVAAHYCntRIjI6hkYYZWGQRUGm2ltMssVsiSKCAVGMZqWFZ4fDY4XYn7ULaEgF182N/Me9cIuI3kY9gFodLAEHINFgKDKdqwK1LVotOMSsnWz5JAPYUeJZyTiKMVwv2n+la08npcZOBjke3LVWZtRuizE4kI5f/8QAIBEBAAIBAgcAAAAAAAAAAAAAAQARAwIQEiAhMTJBcf/aAAgBAgEBPwDL5HzkadfX0RDjmTSUJtks1MqWpVypk7uxt//EACARAQABAwMFAAAAAAAAAAAAAAEAAhEhAxATEiIxYXH/2gAIAQMBAT8A0m1L9l+2++Sg9sF45p1N7M6iUJYwM5GYW4ZmZT4Njb//2Q==",name:"柚子",text:"什么冬梅？"}],U=["1","2","3","4","5","6","7","8","9"],j=()=>U.map(((e,a)=>{const A=a%3;return{avatar:R[A].avatar,name:R[A].name,text:e}}));var F=r({name:"vue3-danmaku",components:{},props:{danmus:{type:Array,required:!0,default:()=>[]},channels:{type:Number,default:0},autoplay:{type:Boolean,default:!0},loop:{type:Boolean,default:!1},useSlot:{type:Boolean,default:!1},debounce:{type:Number,default:100},speeds:{type:Number,default:200},randomChannel:{type:Boolean,default:!1},fontSize:{type:Number,default:18},top:{type:Number,default:4},right:{type:Number,default:0},isSuspend:{type:Boolean,default:!1},extraStyle:{type:String,default:""}},emits:["list-end","play-end","dm-over","dm-out","update:danmus"],setup(e,{emit:a,slots:A}){let t=c(document.createElement("div")),n=c(document.createElement("div"));const l=c(0),s=c(0);let u=0;const o=c(0),i=c(0),d=c(0),r=c(!1),h=c(!1),C=c({}),y=function(e,a,A="modelValue"){return m({get:()=>e[A],set:e=>{a(`update:${A}`,e)}})}(e,a,"danmus"),Q=p({channels:m((()=>e.channels||o.value)),autoplay:m((()=>e.autoplay)),loop:m((()=>e.loop)),useSlot:m((()=>e.useSlot)),debounce:m((()=>e.debounce)),randomChannel:m((()=>e.randomChannel))}),w=p({height:m((()=>i.value)),fontSize:m((()=>e.fontSize)),speeds:m((()=>e.speeds)),top:m((()=>e.top)),right:m((()=>e.right))});function k(){I(),e.isSuspend&&function(){let e=[];n.value.addEventListener("mouseover",(A=>{let t=A.target;t.className.includes("dm")||(t=t.closest(".dm")||t),t.className.includes("dm")&&(e.includes(t)||(a("dm-over",{el:t}),t.classList.add("pause"),e.push(t)))})),n.value.addEventListener("mouseout",(A=>{let t=A.target;t.className.includes("dm")||(t=t.closest(".dm")||t),t.className.includes("dm")&&(a("dm-out",{el:t}),t.classList.remove("pause"),e.forEach((e=>{e.classList.remove("pause")})),e=[])}))}(),Q.autoplay&&x()}function I(){if(l.value=t.value.offsetWidth,s.value=t.value.offsetHeight,0===l.value||0===s.value)throw new Error("获取不到容器宽高")}function x(){h.value=!1,u||(u=window.setInterval((()=>function(){if(!h.value&&y.value.length)if(d.value>y.value.length-1){const e=n.value.children.length;Q.loop&&(e<d.value&&(a("list-end"),d.value=0),b())}else b()}()),Q.debounce))}function b(t){const u=Q.loop?d.value%y.value.length:d.value,r=t||y.value[u];let c=document.createElement("div");var m,p;Q.useSlot?c=(m=r,p=u,g({render:()=>E("div",{},[A.dm&&A.dm({danmu:m,index:p})])}).mount(document.createElement("div"))).$el:(c.innerHTML=r,c.setAttribute("style",e.extraStyle),c.style.fontSize=`${w.fontSize}px`,c.style.lineHeight=`${w.fontSize}px`),c.classList.add("dm"),n.value.appendChild(c),c.style.opacity="0",B((()=>{w.height||(i.value=c.offsetHeight),Q.channels||(o.value=Math.floor(s.value/(w.height+w.top)));let e=function(e){let a=[...Array(Q.channels).keys()];Q.randomChannel&&(a=a.sort((()=>.5-Math.random())));for(let A of a){const a=C.value[A];if(!a||!a.length)return C.value[A]=[e],e.addEventListener("animationend",(()=>C.value[A].splice(0,1))),A%Q.channels;for(let t=0;t<a.length;t++){const n=M(a[t])-10;if(n<=.88*(e.offsetWidth-a[t].offsetWidth)||n<=0)break;if(t===a.length-1)return C.value[A].push(e),e.addEventListener("animationend",(()=>C.value[A].splice(0,1))),A%Q.channels}}return-1}(c);if(e>=0){const A=c.offsetWidth,t=w.height;c.classList.add("move"),c.dataset.index=`${u}`,c.dataset.channel=e.toString(),c.style.opacity="1",c.style.top=e*(t+w.top)+"px",c.style.width=A+w.right+"px",c.style.setProperty("--dm-scroll-width",`-${l.value+A}px`),c.style.left=`${l.value}px`,c.style.animationDuration=l.value/w.speeds+"s",c.addEventListener("animationend",(()=>{Number(c.dataset.index)!==y.value.length-1||Q.loop||a("play-end",c.dataset.index),n.value&&n.value.removeChild(c)})),d.value++}else n.value.removeChild(c)}))}function M(e){const a=e.offsetWidth||parseInt(e.style.width),A=e.getBoundingClientRect().right||n.value.getBoundingClientRect().right+a;return n.value.getBoundingClientRect().right-A}function S(){clearInterval(u),u=0,d.value=0}return f((()=>{k()})),v((()=>{S()})),{container:t,dmContainer:n,hidden:r,paused:h,danmuList:y,getPlayState:function(){return!h.value},resize:function(){I();const e=n.value.getElementsByClassName("dm");for(let a=0;a<e.length;a++){const A=e[a];A.style.setProperty("--dm-scroll-width",`-${l.value+A.offsetWidth}px`),A.style.left=`${l.value}px`,A.style.animationDuration=l.value/w.speeds+"s"}},play:x,pause:function(){h.value=!0},stop:function(){C.value={},n.value.innerHTML="",h.value=!0,r.value=!1,S()},show:function(){r.value=!1},hide:function(){r.value=!0},reset:function(){i.value=0,k()},add:function(e){if(d.value===y.value.length)return y.value.push(e),y.value.length-1;{const a=d.value%y.value.length;return y.value.splice(a,0,e),a+1}},push:function(e){return y.value.push(e),y.value.length-1},insert:b}}});const Y={ref:"container",class:"vue-danmaku"};!function(e,a){void 0===a&&(a={});var A=a.insertAt;if("undefined"!=typeof document){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===A&&t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}(".vue-danmaku {\n  position: relative;\n  overflow: hidden;\n}\n.vue-danmaku .danmus {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  opacity: 0;\n  -webkit-transition: all 0.3s;\n  transition: all 0.3s;\n}\n.vue-danmaku .danmus.show {\n  opacity: 1;\n}\n.vue-danmaku .danmus.paused .dm.move {\n  animation-play-state: paused;\n}\n.vue-danmaku .danmus .dm {\n  position: absolute;\n  font-size: 20px;\n  color: #ddd;\n  white-space: pre;\n  transform: translateX(0);\n  transform-style: preserve-3d;\n}\n.vue-danmaku .danmus .dm.move {\n  will-change: transform;\n  animation-name: moveLeft;\n  animation-timing-function: linear;\n  animation-play-state: running;\n}\n.vue-danmaku .danmus .dm.pause {\n  animation-play-state: paused;\n  z-index: 100;\n}\n@keyframes moveLeft {\n  from {\n    transform: translateX(0);\n  }\n  to {\n    transform: translateX(var(--dm-scroll-width));\n  }\n}\n@-webkit-keyframes moveLeft {\n  from {\n    -webkit-transform: translateX(0);\n  }\n  to {\n    -webkit-transform: translateX(var(--dm-scroll-width));\n  }\n}"),F.render=function(e,a,A,t,n,l){return h(),u("div",Y,[o("div",{ref:"dmContainer",class:i(["danmus",{show:!e.hidden},{paused:e.paused}])},null,2),d(e.$slots,"default")],512)},F.__file="src/lib/Danmaku.vue";const G={class:"card-header"},K={class:"font-medium"},V={class:"flex gap-5"},P={class:"danmu-item"},z=["src"],W={class:"main"},L={class:"ml-5"},T={class:"ml-5"},N={class:"ml-5"},H={class:"flex"},O=r((J=((e,a)=>{for(var A in a||(a={}))n.call(a,A)&&s(e,A,a[A]);if(t)for(var A of t(a))l.call(a,A)&&s(e,A,a[A]);return e})({},{name:"Danmaku"}),a(J,A({__name:"index",setup(e){const a=c(),A=c(j()),t=c("");let n=0;const l=p({channels:5,useSlot:!0,loop:!0,speeds:200,fontSize:20,top:10,right:0,debounce:100,randomChannel:!0});function s(e){switch(e){case"play":a.value.play();break;case"pause":a.value.pause();break;case"stop":a.value.stop();break;case"show":a.value.show();break;case"hide":a.value.hide();break;case"reset":a.value.reset()}}function u(e){l.useSlot=e,A.value=e?j():U,setTimeout((()=>{a.value.stop(),a.value.play()}))}function i(e){l.speeds<=10&&-10===e||(l.speeds+=e,a.value.reset())}function d(e){l.fontSize+=e,a.value.reset()}function r(e){(l.channels||-1!==e)&&(l.channels+=e)}function m(){if(!t.value)return;const e=l.useSlot?{avatar:"https://i.loli.net/2021/01/17/xpwbm3jKytfaNOD.jpg",name:"你",text:t.value}:t.value;a.value.add(e),t.value=""}return f((()=>{window.onresize=()=>(n&&clearTimeout(n),void(n=window.setTimeout((()=>{a.value.resize()}),500)))})),C((()=>{window.onresize=null})),(e,n)=>{const c=w("el-link"),p=w("el-button"),f=w("el-input"),v=w("el-card");return h(),y(v,{shadow:"never"},{header:Q((()=>[o("div",G,[o("span",K,[k(" 弹幕组件，采用开源的 "),I(c,{href:"https://github.com/hellodigua/vue-danmaku/tree/vue3",target:"_blank",style:{margin:"0 4px 5px","font-size":"16px"}},{default:Q((()=>[k(" vue3-danmaku ")])),_:1})])]),I(c,{class:"mt-2",href:"https://github.com/pure-admin/vue-pure-admin/blob/main/src/views/able/danmaku",target:"_blank"},{default:Q((()=>[k(" 代码位置 src/views/able/danmaku ")])),_:1})])),default:Q((()=>[o("div",V,[I(M(F),b({ref_key:"danmaku",ref:a,danmus:A.value,"onUpdate:danmus":n[0]||(n[0]=e=>A.value=e),class:"demo",isSuspend:""},l),{dm:Q((({danmu:e,index:a})=>[o("div",P,[o("img",{class:"img",src:e.avatar},null,8,z),o("span",null,x(a)+x(e.name)+"：",1),o("span",null,x(e.text),1)])])),_:1},16,["danmus"]),o("div",W,[o("p",null,[k(" 播放： "),I(p,{onClick:n[1]||(n[1]=e=>s("play"))},{default:Q((()=>[k("播放")])),_:1}),I(p,{onClick:n[2]||(n[2]=e=>s("pause"))},{default:Q((()=>[k("暂停")])),_:1}),I(p,{onClick:n[3]||(n[3]=e=>s("stop"))},{default:Q((()=>[k("停止")])),_:1})]),o("p",null,[k(" 模式： "),I(p,{onClick:n[4]||(n[4]=e=>u(!0))},{default:Q((()=>[k("弹幕 slot")])),_:1}),I(p,{onClick:n[5]||(n[5]=e=>u(!1))},{default:Q((()=>[k("普通文本")])),_:1})]),o("p",null,[k(" 显示： "),I(p,{onClick:n[6]||(n[6]=e=>s("show"))},{default:Q((()=>[k("显示")])),_:1}),I(p,{onClick:n[7]||(n[7]=e=>s("hide"))},{default:Q((()=>[k("隐藏")])),_:1})]),o("p",null,[k(" 速度： "),I(p,{onClick:n[8]||(n[8]=e=>i(-10))},{default:Q((()=>[k("减速")])),_:1}),I(p,{onClick:n[9]||(n[9]=e=>i(10))},{default:Q((()=>[k("增速")])),_:1}),o("span",L,"当前速度："+x(l.speeds)+"像素/s",1)]),o("p",null,[k(" 字号： "),I(p,{disabled:l.useSlot,onClick:n[10]||(n[10]=e=>d(-1))},{default:Q((()=>[k(" 缩小 ")])),_:1},8,["disabled"]),I(p,{disabled:l.useSlot,onClick:n[11]||(n[11]=e=>d(1))},{default:Q((()=>[k(" 放大 ")])),_:1},8,["disabled"]),o("span",T,"当前字号："+x(l.fontSize)+"px",1)]),o("p",null,[k(" 轨道： "),I(p,{onClick:n[12]||(n[12]=e=>r(-1))},{default:Q((()=>[k("-1")])),_:1}),I(p,{onClick:n[13]||(n[13]=e=>r(1))},{default:Q((()=>[k("+1")])),_:1}),I(p,{onClick:n[14]||(n[14]=e=>r(-l.channels))},{default:Q((()=>[k(" 填满 ")])),_:1}),o("span",N,"当前轨道："+x(l.channels),1)]),o("p",H,[I(f,{modelValue:t.value,"onUpdate:modelValue":n[15]||(n[15]=e=>t.value=e),type:"text",placeholder:"输入评论后，回车发送弹幕",onKeyup:S(m,["enter"])},null,8,["modelValue"])])])])])),_:1})}}}))));var J;const X=D(O,[["__scopeId","data-v-d4dc730e"]]);export{X as default};
