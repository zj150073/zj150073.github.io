var t=Object.defineProperty,e=(e,r,o)=>((e,r,o)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o)(e,"symbol"!=typeof r?r+"":r,o);class r{constructor(t,r=0){e(this,"depth",0),e(this,"key"),e(this,"word",!1),e(this,"children",{}),e(this,"fail"),e(this,"count",0),this.key=t,this.depth=r}}const o=class{constructor(t,o){e(this,"root",new r("root")),e(this,"customCharacter");const i=t.length;this.customCharacter=(null==o?void 0:o.customCharacter)||"*";for(let e=0;e<i;e++)this.add(t[e],!1);this.build()}build(){const t=[];t.push(this.root);let e=0;for(;t.length>e;){const r=t[e],o=r.children;for(const e in r.children){const i=o[e];let s=r.fail;for(;s&&!s.children[e];)s=s.fail;i.fail=(null==s?void 0:s.children[e])||this.root,t.push(i)}e++}}search(t,e={replace:!0}){let r=this.root;const o=[],i=[],s=[],{replace:n=!0,verify:l=!1}=e,h=t.length;for(let c=0;c<h;c++){const e=t[c],h=e.toLowerCase();for(;r&&!(null==r?void 0:r.children[h]);)r=null==r?void 0:r.fail;if(r=(null==r?void 0:r.children[h])||this.root,o.push(e),i.push(e),r.word){let t=c+1-r.depth,e="";for(;t<=c;){e+=i[t],n&&(o[t]=this.customCharacter),t++}if(s.push(e),l)break}}return{words:s,text:o.join("")}}filter(t,e){return this.search(t,e)}verify(t){const{words:e}=this.search(t,{verify:!0});return!e.length}delete(t){const e=this.pop(t.toLowerCase(),t.length,this.root);return this.build(),e}pop(t,e,r,o="delete",i=0){if(!r)return"delete";if(i===e){r.word=!1,r.count--;let t=!0;for(const e in r.children)if(e){t=!1;break}return t?o:"update"}{const s=t[i],n=r.children[s],l=this.pop(t,e,n,r.word?"update":o,i+1);return r.count--,"delete"===l&&0===(null==n?void 0:n.count)&&delete r.children[s],l}}add(t,e=!0){const r=t.toLowerCase(),o=r.length;return this.put(r,o),e&&this.build(),!0}put(t,e){let o=this.root;const i=e-1;o.count++;for(let s=0;s<e;s++){const e=t[s],n=o.children[e];if(n)n.count++,o=n;else{const t=new r(e,s+1);t.count=1,o.children[e]=t,o=t}i===s&&o.depth&&(o.word=!0)}}};export{o as M};
