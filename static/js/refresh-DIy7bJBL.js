var ae=Object.defineProperty;var I=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var O=(e,i,a)=>i in e?ae(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,F=(e,i)=>{for(var a in i||(i={}))ne.call(i,a)&&O(e,a,i[a]);if(I)for(var a of I(i))re.call(i,a)&&O(e,a,i[a]);return e};var $=(e,i,a)=>new Promise((B,c)=>{var x=o=>{try{f(a.next(o))}catch(s){c(s)}},g=o=>{try{f(a.throw(o))}catch(s){c(s)}},f=o=>o.done?B(o.value):Promise.resolve(o.value).then(x,g);f((a=a.apply(e,i)).next())});import{S as ue}from"./sortable.esm-CkCitmyH.js";import{d as ie,a as h,Z as oe,ag as b,ft as ce,ad as se,am as R,p as M,i as t,a5 as de,F as H,B as D,A,e as u,h as S,u as K,ac as p,aD as fe,cV as ve,y as he,X as be}from"./index-BdQqVUXy.js";import{u as ge}from"./epTheme-Dnhv8HVo.js";import{E as me,R as pe,C as xe,D as ye,S as Ce}from"./collapse-x9Ji0cxk.js";function ke(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!fe(e)}const we={title:{type:String,default:"列表"},tableRef:{type:Object},columns:{type:Array,default:()=>[]},isExpandAll:{type:Boolean,default:!0},tableKey:{type:[String,Number],default:"0"}},Ee=ie({name:"PureTableBar",props:we,emits:["refresh"],setup(e,{emit:i,slots:a,attrs:B}){const c=h("default"),x=h(!1),g=h(!0),f=h(!1),o=oe(),s=h(e.isExpandAll),P=b(e==null?void 0:e.columns).filter(l=>ce(l==null?void 0:l.hide)?!l.hide:!(se(l==null?void 0:l.hide)&&(l!=null&&l.hide())));let m=R(b(e==null?void 0:e.columns),"label");const C=h(R(b(P),"label")),d=h(b(e==null?void 0:e.columns)),T=M(()=>l=>({background:l===c.value?ge().epThemeColor:"",color:l===c.value?"#fff":"var(--el-text-color-primary)"})),k=M(()=>["text-black","dark:text-white","duration-100","hover:!text-primary","cursor-pointer","outline-none"]),G=M(()=>["flex","justify-between","pt-[3px]","px-[11px]","border-b-[1px]","border-solid","border-[#dcdfe6]","dark:border-[#303030]"]);function L(){x.value=!0,i("refresh"),ve(500).then(()=>x.value=!1)}function U(){s.value=!s.value,_(e.tableRef.data,s.value)}function _(l,r){l.forEach(n=>{e.tableRef.toggleRowExpansion(n,r),n.children!==void 0&&n.children!==null&&_(n.children,r)})}function W(l){C.value=l?m:[],f.value=!1,d.value.map(r=>l?r.hide=!1:r.hide=!0)}function X(l){C.value=l;const r=l.length;g.value=r===m.length,f.value=r>0&&r<m.length}function Z(l,r){d.value.filter(n=>p(n.label)===p(r))[0].hide=!l}function q(){return $(this,null,function*(){g.value=!0,f.value=!1,d.value=b(e==null?void 0:e.columns),m=[],m=yield R(b(e==null?void 0:e.columns),"label"),C.value=R(b(P),"label")})}const J={dropdown:()=>t(u("el-dropdown-menu"),{class:"translation"},{default:()=>[t(u("el-dropdown-item"),{style:T.value("large"),onClick:()=>c.value="large"},{default:()=>[S("宽松")]}),t(u("el-dropdown-item"),{style:T.value("default"),onClick:()=>c.value="default"},{default:()=>[S("默认")]}),t(u("el-dropdown-item"),{style:T.value("small"),onClick:()=>c.value="small"},{default:()=>[S("紧凑")]})]})},Q=l=>{l.preventDefault(),he(()=>{var n;const r=((n=o==null?void 0:o.proxy)==null?void 0:n.$refs[`GroupRef${K(e.tableKey)}`]).$el.firstElementChild;ue.create(r,{animation:300,handle:".drag-btn",onEnd:({newIndex:y,oldIndex:v,item:le})=>{const V=le,j=V.parentNode,z=d.value[v],N=d.value[y];if(z!=null&&z.fixed||N!=null&&N.fixed){const E=j.children[v];y>v?j.insertBefore(V,E):j.insertBefore(V,E&&E.nextElementSibling);return}const te=d.value.splice(v,1)[0];d.value.splice(y,0,te)}})})},Y=l=>!!d.value.filter(r=>p(r.label)===p(l))[0].fixed,w=l=>({content:l,offset:[0,18],duration:[300,0],followCursor:!0,hideOnClick:"toggle"}),ee={reference:()=>D(t(Ce,{class:["w-[16px]",k.value]},null),[[A("tippy"),w("列设置")]])};return()=>{var r;let l;return t(H,null,[t("div",de(B,{class:"w-[99/100] mt-2 px-2 pb-2 bg-bg_color"}),[t("div",{class:"flex justify-between w-full h-[60px] p-4"},[a!=null&&a.title?a.title():t("p",{class:"font-bold truncate"},[e.title]),t("div",{class:"flex items-center justify-around"},[a!=null&&a.buttons?t("div",{class:"flex mr-4"},[a.buttons()]):null,(r=e.tableRef)!=null&&r.size?t(H,null,[D(t(me,{class:["w-[16px]",k.value],style:{transform:s.value?"none":"rotate(-90deg)"},onClick:()=>U()},null),[[A("tippy"),w(s.value?"折叠":"展开")]]),t(u("el-divider"),{direction:"vertical"},null)]):null,D(t(pe,{class:["w-[16px]",k.value,x.value?"animate-spin":""],onClick:()=>L()},null),[[A("tippy"),w("刷新")]]),t(u("el-divider"),{direction:"vertical"},null),D(t(u("el-dropdown"),{trigger:"click"},F({default:()=>[t(xe,{class:["w-[16px]",k.value]},null)]},J)),[[A("tippy"),w("密度")]]),t(u("el-divider"),{direction:"vertical"},null),t(u("el-popover"),{placement:"bottom-start","popper-style":{padding:0},width:"200",trigger:"click"},F({default:()=>[t("div",{class:[G.value]},[t(u("el-checkbox"),{class:"!-mr-1",label:"列展示",modelValue:g.value,"onUpdate:modelValue":n=>g.value=n,indeterminate:f.value,onChange:n=>W(n)},null),t(u("el-button"),{type:"primary",link:!0,onClick:()=>q()},{default:()=>[S("重置")]})]),t("div",{class:"pt-[6px] pl-[11px]"},[t(u("el-scrollbar"),{"max-height":"36vh"},{default:()=>[t(u("el-checkbox-group"),{ref:`GroupRef${K(e.tableKey)}`,modelValue:C.value,onChange:n=>X(n)},{default:()=>[t(u("el-space"),{direction:"vertical",alignment:"flex-start",size:0},ke(l=m.map((n,y)=>t("div",{class:"flex items-center"},[t(ye,{class:["drag-btn w-[16px] mr-2",Y(n)?"!cursor-no-drop":"!cursor-grab"],onMouseenter:v=>Q(v)},null),t(u("el-checkbox"),{key:y,label:n,value:n,onChange:v=>Z(v,n)},{default:()=>[t("span",{title:p(n),class:"inline-block w-[120px] truncate hover:text-text_color_primary"},[p(n)])]})])))?l:{default:()=>[l]})]})]})])]},ee))])]),a.default({size:c.value,dynamicColumns:d.value})])])}}}),Ve=be(Ee),Re={width:1024,height:1024,body:'<path fill="currentColor" d="M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"/>'},je=Re;export{Ve as P,je as R};
