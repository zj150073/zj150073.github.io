import{d as e}from"./dayjs-BWHVJBZs.js";import{_ as t}from"./detail.vue_vue_type_script_setup_true_lang-DJ1s9bfR.js";import{m as i,a as s}from"./index-CQT2hjpo.js";import{Y as o,g as r}from"./@pureadmin-f9nW_l6N.js";import{b as a,c as p}from"./system-efgH8gGi.js";import{at as n}from"./@iconify-icons-CxRB8ffa.js";import{S as l,r as m,J as u,s as c,E as j,i as d,P as f,a1 as h,a6 as v}from"./@vue-CFXrvzpc.js";import"./@amap-Bx2D3lnM.js";import"./vue-json-pretty-DAWMADQc.js";import"./vite-plugin-fake-server-CytHVkXj.js";import"./@faker-js-CRy60TLX.js";import"./version-rocket-chvOQqaV.js";import"./@vueuse-tP1Y4vdd.js";import"./defu-iUM7Auia.js";import"./framesync-CUhBu5sQ.js";import"./style-value-types-UCYNu-x1.js";import"./popmotion-DRTv1-mp.js";import"./hey-listen-DkH12NBk.js";import"./element-plus-DsFyl0Kk.js";import"./lodash-es-BgzC0s9P.js";import"./@element-plus-Bqpau_gV.js";import"./@popperjs-D3lHDW-0.js";import"./@ctrl-D2oWfImC.js";import"./async-validator-Cuo4gI4y.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-Vn5vHDCm.js";import"./@floating-ui-kghe82LF.js";import"./plus-pro-components-CYEVFP0q.js";import"./sortablejs-DhhifNSC.js";import"./axios-B1L2Kzed.js";import"./vue-i18n-DB-7wkrF.js";import"./@intlify-DfwD9yJy.js";import"./js-cookie-BXEMiIsG.js";import"./pinia-DzAV29mk.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-CGx-uoKe.js";import"./axs-request-CnYniYE7.js";import"./nprogress-L6f6pfEY.js";import"./echarts-D2b6xzX-.js";import"./zrender-CUz1GrA9.js";import"./tslib-ZseNXxlj.js";import"./vxe-table-CPtn8uUL.js";import"./xe-utils-CdBoVBzI.js";import"./dom-zindex-Ckn4mXSH.js";import"./responsive-storage-5vfjqqcs.js";import"./vue-DWYrQbHy.js";import"./@iconify-BUzAfhQo.js";/* empty css                 */import"./vue-tippy-DPYCMIfw.js";function g(g){const y=l({module:"",requestTime:""}),b=m([]),x=m(!0),S=m(0),{copied:k,update:z}=o(),T=l({total:0,pageSize:10,currentPage:1,background:!0}),W=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"ID",prop:"id",minWidth:90},{label:"所属模块",prop:"module",minWidth:100},{headerRenderer:()=>c("span",{class:"flex-c"},[j("请求接口"),d(c(h("iconifyIconOffline"),{icon:n,class:"ml-1 cursor-help"},null),[[f("tippy"),{content:"双击下面请求接口进行拷贝"}]])]),prop:"url",minWidth:140},{label:"请求方法",prop:"method",minWidth:140},{label:"IP 地址",prop:"ip",minWidth:100},{label:"地点",prop:"address",minWidth:140},{label:"操作系统",prop:"system",minWidth:100},{label:"浏览器类型",prop:"browser",minWidth:100},{label:"请求耗时",prop:"takesTime",minWidth:100,cellRenderer:({row:e,props:t})=>c(h("el-tag"),{size:t.size,type:e.takesTime<1e3?"success":"warning",effect:"plain"},{default:()=>[e.takesTime,j(" ms")]})},{label:"请求时间",prop:"requestTime",minWidth:180,formatter:({requestTime:t})=>e(t).format("YYYY-MM-DD HH:mm:ss")},{label:"操作",fixed:"right",slot:"operation"}];function w(){return e=this,t=null,i=function*(){x.value=!0;const{data:e}=yield p(v(y));b.value=e.list,T.total=e.total,T.pageSize=e.pageSize,T.currentPage=e.currentPage,setTimeout((()=>{x.value=!1}),500)},new Promise(((s,o)=>{var r=e=>{try{p(i.next(e))}catch(t){o(t)}},a=e=>{try{p(i.throw(e))}catch(t){o(t)}},p=e=>e.done?s(e.value):Promise.resolve(e.value).then(r,a);p((i=i.apply(e,t)).next())}));var e,t,i}return u((()=>{w()})),{form:y,loading:x,columns:W,dataList:b,pagination:T,selectedNum:S,onSearch:w,onDetail:function(e){a({id:e.id}).then((e=>{s({title:"系统日志详情",fullscreen:!0,hideFooter:!0,contentRenderer:()=>t,props:{data:[e]}})}))},clearAll:function(){i("已删除所有日志数据",{type:"success"}),w()},resetForm:e=>{e&&(e.resetFields(),w())},onbatchDel:function(){const e=g.value.getTableRef().getSelectionRows();i(`已删除序号为 ${r(e,"id")} 的数据`,{type:"success"}),g.value.getTableRef().clearSelection(),w()},handleSizeChange:function(e){},onSelectionCancel:function(){S.value=0,g.value.getTableRef().clearSelection()},handleCellDblclick:function({url:e},{property:t}){"url"===t&&(z(e),k.value?i(`${e} 已拷贝`,{type:"success"}):i("拷贝失败",{type:"warning"}))},handleCurrentChange:function(e){},handleSelectionChange:function(e){S.value=e.length,g.value.setAdaptive()}}}export{g as useRole};
