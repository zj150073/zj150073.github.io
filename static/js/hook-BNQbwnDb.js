import{r as e,a as t,m as a,i as l,e as n,aV as i,L as o,am as r,bk as s}from"./index-07XH1eRd.js";import{a as u}from"./system-hdjNX1A0.js";import{u as c}from"./hooks-DaK0hl85.js";function p(p){const m=e({module:"",status:"",operatingTime:""}),d=t([]),h=t(!0),g=t(0),{tagStyle:f}=c(),b=e({total:0,pageSize:10,currentPage:1,background:!0}),v=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"序号",prop:"id",minWidth:90},{label:"操作人员",prop:"username",minWidth:100},{label:"所属模块",prop:"module",minWidth:140},{label:"操作概要",prop:"summary",minWidth:140},{label:"操作 IP",prop:"ip",minWidth:100},{label:"操作地点",prop:"address",minWidth:140},{label:"操作系统",prop:"system",minWidth:100},{label:"浏览器类型",prop:"browser",minWidth:100},{label:"操作状态",prop:"status",minWidth:100,cellRenderer:({row:e,props:t})=>l(n("el-tag"),{size:t.size,style:f.value(e.status)},{default:()=>[1===e.status?"成功":"失败"]})},{label:"操作时间",prop:"operatingTime",minWidth:180,formatter:({operatingTime:e})=>i(e).format("YYYY-MM-DD HH:mm:ss")}];function y(){return e=this,t=null,a=function*(){h.value=!0;const{data:e}=yield u(s(m));d.value=e.list,b.total=e.total,b.pageSize=e.pageSize,b.currentPage=e.currentPage,setTimeout((()=>{h.value=!1}),500)},new Promise(((l,n)=>{var i=e=>{try{r(a.next(e))}catch(t){n(t)}},o=e=>{try{r(a.throw(e))}catch(t){n(t)}},r=e=>e.done?l(e.value):Promise.resolve(e.value).then(i,o);r((a=a.apply(e,t)).next())}));var e,t,a}return a((()=>{y()})),{form:m,loading:h,columns:v,dataList:d,pagination:b,selectedNum:g,onSearch:y,clearAll:function(){o("已删除所有日志数据",{type:"success"}),y()},resetForm:e=>{e&&(e.resetFields(),y())},onbatchDel:function(){const e=p.value.getTableRef().getSelectionRows();o(`已删除序号为 ${r(e,"id")} 的数据`,{type:"success"}),p.value.getTableRef().clearSelection(),y()},handleSizeChange:function(e){},onSelectionCancel:function(){g.value=0,p.value.getTableRef().clearSelection()},handleCurrentChange:function(e){},handleSelectionChange:function(e){g.value=e.length,p.value.setAdaptive()}}}export{p as useRole};
