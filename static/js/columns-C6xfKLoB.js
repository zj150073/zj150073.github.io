var e=Object.defineProperty,n=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,i=(n,t,a)=>t in n?e(n,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[t]=a,o=(e,n,t)=>new Promise(((a,i)=>{var o=e=>{try{_(t.next(e))}catch(n){i(n)}},u=e=>{try{_(t.throw(e))}catch(n){i(n)}},_=e=>e.done?a(e.value):Promise.resolve(e.value).then(o,u);_((t=t.apply(e,n)).next())}));import{a as u}from"./data-7xVGzIsj.js";import{k as _,m as r}from"./index-DK9WUj9J.js";const m=function(e){let n=Array.isArray(e)?[]:{};if(e&&"object"==typeof e)for(let t in e)e.hasOwnProperty(t)&&(e[t]&&"object"==typeof e[t]?n[t]=m(e[t]):n[t]=e[t]);return n};var l=Vue.defineComponent({name:"MouseMenu",props:{appendToBody:{type:Boolean,default:!0},menuWidth:{type:Number,default:200},menuList:{type:Array,required:!0},menuHiddenFn:{type:Function},hasIcon:{type:Boolean,default:!1},iconType:{type:String,default:"font-icon"},menuWrapperCss:Object,menuItemCss:Object,el:{type:Object,required:!0},params:{type:[String,Number,Array,Object]},useLongPressInMobile:Boolean,longPressDuration:Number,longPressPreventDefault:[Function,Boolean],injectCloseListener:{type:Boolean,default:!0},customClass:String,disabled:{type:Function}},emits:["open","close"],setup(e,{emit:n}){const t=Vue.ref(0),a=Vue.ref(0),i=Vue.ref(!1),u=Vue.ref(0),_=Vue.ref(0),r=Vue.ref(!1),l=Vue.ref(null),d=Vue.ref([]),s=Vue.computed((()=>e.menuList.some((e=>e.children&&e.children.length>0)))),c=Vue.ref(10),p=Vue.ref();Vue.watch(r,(t=>o(this,null,(function*(){var a,i;if(t){yield Vue.nextTick();let t=p.value;e.menuWrapperCss&&Object.keys(e.menuWrapperCss).map((n=>{t.style.setProperty(`--menu-${n}`,e.menuWrapperCss&&e.menuWrapperCss[n])})),e.menuItemCss&&Object.keys(e.menuItemCss).map((n=>{t.style.setProperty(`--menu-item-${n}`,e.menuItemCss&&e.menuItemCss[n])}));let o=null==(i=null==(a=e.menuItemCss)?void 0:a.arrowSize)?void 0:i.match(/\d+/);c.value=o&&~~o[0]||10,t.style.setProperty("--menu-item-arrowRealSize",c.value/2+"px"),n("open",e.params,l.value,e.el)}else n("close",e.params,l.value,e.el)}))));const b=(e,n,t,a)=>e.map((e=>(e.children&&(e.children=b(e.children,n,t,a)),e.label&&"function"==typeof e.label&&(e.label=e.label(a,n,t)),e.tips&&"function"==typeof e.tips&&(e.tips=e.tips(a,n,t)),e.icon&&"function"==typeof e.icon&&(e.icon=e.icon(a,n,t)),e.hidden&&"function"==typeof e.hidden&&(e.hidden=e.hidden(a,n,t)),e.disabled&&"function"==typeof e.disabled&&(e.disabled=e.disabled(a,n,t)),e))),v=Vue.computed((()=>e.useLongPressInMobile&&"ontouchstart"in window?"touchstart":"mousedown")),h=e=>{p.value&&!p.value.contains(e.currentTarget)&&(r.value=!1,document.oncontextmenu=null)};return Vue.watch((()=>e.injectCloseListener),(e=>{e?document.addEventListener(v.value,h):document.removeEventListener(v.value,h)}),{immediate:!0}),Vue.onUnmounted((()=>{document.removeEventListener(v.value,h)})),{subLeft:t,subTop:a,hoverFlag:i,menuTop:u,menuLeft:_,showMenu:r,clickDomEl:l,calcMenuList:d,arrowSize:c,hasSubMenu:s,MenuWrapper:p,handleMenuItemClick:(n,t)=>{n.disabled||(n.fn&&"function"==typeof n.fn&&n.fn(e.params,l.value,e.el,t),r.value=!1)},handleSubMenuItemClick:(n,t)=>{n.disabled||(n.fn&&"function"==typeof n.fn&&!n.disabled&&(n.fn(e.params,l.value,e.el,t),i.value=!1),r.value=!1)},handleMenuMouseEnter:(e,n)=>{if(n.children&&!n.disabled){i.value=!0;const n=e.currentTarget;if(!n)return;const{offsetWidth:o}=n,u=n.querySelector(".__menu__sub__wrapper");if(!u)return;const{offsetWidth:_,offsetHeight:r}=u,{innerWidth:m,innerHeight:l}=window,{top:d,left:s}=n.getBoundingClientRect();t.value=s+o+_>m-5?s-_+5:s+o,a.value=d+r>l-5?l-r:d+5}},show:(n=0,t=0)=>o(this,null,(function*(){if(l.value=document.elementFromPoint(n-1,t-1),e.menuHiddenFn?r.value=!e.menuHiddenFn(e.params,l.value,e.el):r.value=!0,!r.value)return;d.value=m(e.menuList),d.value=b(d.value,l.value,e.el,e.params),yield Vue.nextTick();const{innerWidth:a,innerHeight:i}=window,o=p.value.offsetHeight,s=e.menuWidth||200;_.value=n+s+1>a?a-s-5:n+1,u.value=t+o+1>i?i-o-5:t+1})),close:()=>{r.value=!1},clickEventKey:v}}});const d=["onMouseenter"],s={key:0,class:"__menu__item-icon"},c=["innerHTML"],p={class:"__menu__item-label"},b={class:"__menu__item-tips"},v={class:"__menu__item-arrow-after"},h={class:"__menu__sub__item-label"},f={class:"__menu__sub__item-tips"};function V(e){var n;const t="__mouse__menu__container";let a;a=document.querySelector(`.${t}`)?document.querySelector(`.${t}`):function(e,n){let t=document.createElement(e);return t.setAttribute("class",n),t}("div",t);const i=Vue.createVNode(l,e);return Vue.render(i,a),document.body.appendChild(a),null==(n=i.component)?void 0:n.proxy}function y(){const e=Vue.ref(_(u,!0)),o={menuList:[{label:({id:e})=>`ID为：${e}`,disabled:!0},{label:"修改",tips:"Edit",fn:n=>r(`您修改了第 ${e.value.findIndex((e=>e.id===n.id))+1} 行，数据为：${JSON.stringify(n)}`,{type:"success"})}]};return{columns:[{label:"ID",prop:"id"},{label:"日期",prop:"date"},{label:"姓名",prop:"name"}],dataList:e,showMouseMenu:function(e,u,_){_.preventDefault();const{x:r,y:m}=_;V(((e,o)=>{for(var u in o||(o={}))t.call(o,u)&&i(e,u,o[u]);if(n)for(var u of n(o))a.call(o,u)&&i(e,u,o[u]);return e})({el:_.currentTarget,params:e,menuWrapperCss:{background:"var(--el-bg-color)"},menuItemCss:{labelColor:"var(--el-text-color)",hoverLabelColor:"var(--el-color-primary)",hoverTipsColor:"var(--el-color-primary)"}},o)).show(r,m)}}}!function(e,n){void 0===n&&(n={});var t=n.insertAt;if("undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===t&&a.firstChild?a.insertBefore(i,a.firstChild):a.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".__menu__mask[data-v-3d21bc0a] {\n  position: fixed;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  z-index: 999;\n}\n.__menu__wrapper[data-v-3d21bc0a] {\n  --menu-background: #c8f2f0;\n  --menu-boxShadow: 0 1px 5px #888;\n  --menu-padding: 5px 0;\n  --menu-borderRadius: 0;\n  --menu-item-height: 30px;\n  --menu-item-padding: 0 10px;\n  --menu-item-iconSize: 20px;\n  --menu-item-iconFontSize: 14px;\n  --menu-item-iconColor: #484852;\n  --menu-item-labelColor: #484852;\n  --menu-item-labelFontSize: 14px;\n  --menu-item-tipsColor: #889;\n  --menu-item-tipsFontSize: 12px;\n  --menu-item-arrowColor: #484852;\n  --menu-item-disabledColor: #bcc;\n  --menu-item-hoverBackground: rgba(255, 255, 255, 0.8);\n  --menu-item-hoverIconColor: inherit;\n  --menu-item-hoverLabelColor: inherit;\n  --menu-item-hoverTipsColor: inherit;\n  --menu-item-hoverArrowColor: inherit;\n  --menu-lineColor: #ccc;\n  --menu-lineMargin: 5px 0;\n}\n.__menu__wrapper[data-v-3d21bc0a] {\n  position: fixed;\n  width: 200px;\n  background: var(--menu-background);\n  box-shadow: var(--menu-boxShadow);\n  padding: var(--menu-padding);\n  border-radius: var(--menu-borderRadius);\n  z-index: 99999;\n}\n.__menu__line[data-v-3d21bc0a],\n.__menu__sub__line[data-v-3d21bc0a] {\n  border-top: 1px solid var(--menu-lineColor);\n  margin: var(--menu-lineMargin);\n}\n.__menu__item[data-v-3d21bc0a],\n.__menu__sub__item[data-v-3d21bc0a] {\n  display: flex;\n  height: var(--menu-item-height);\n  align-items: center;\n  cursor: pointer;\n  padding: var(--menu-item-padding);\n}\n.__menu__item .__menu__item-icon[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-icon[data-v-3d21bc0a] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: var(--menu-item-iconColor);\n  width: var(--menu-item-iconSize);\n  height: var(--menu-item-iconSize);\n}\n.__menu__item .__menu__item-icon i[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-icon i[data-v-3d21bc0a] {\n  font-size: var(--menu-item-iconFontSize);\n}\n.__menu__item .__menu__item-icon .__menu__item-icon-svg[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-icon .__menu__item-icon-svg[data-v-3d21bc0a] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n}\n.__menu__item .__menu__item-label[data-v-3d21bc0a],\n.__menu__item .__menu__sub__item-label[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-label[data-v-3d21bc0a],\n.__menu__sub__item .__menu__sub__item-label[data-v-3d21bc0a] {\n  width: 100%;\n  max-height: 100%;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  flex: 1;\n  font-size: var(--menu-item-labelFontSize);\n  color: var(--menu-item-labelColor);\n  margin-right: 5px;\n  overflow: hidden;\n}\n.__menu__item .__menu__item-tips[data-v-3d21bc0a],\n.__menu__item .__menu__sub__item-tips[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-tips[data-v-3d21bc0a],\n.__menu__sub__item .__menu__sub__item-tips[data-v-3d21bc0a] {\n  font-size: var(--menu-item-tipsFontSize);\n  color: var(--menu-item-tipsColor);\n}\n.__menu__item .__menu__item-arrow[data-v-3d21bc0a],\n.__menu__sub__item .__menu__item-arrow[data-v-3d21bc0a] {\n  width: 10px;\n  height: 10px;\n  margin-left: 5px;\n  position: relative;\n}\n.__menu__item.disabled[data-v-3d21bc0a],\n.__menu__sub__item.disabled[data-v-3d21bc0a] {\n  cursor: not-allowed;\n}\n.__menu__item.disabled .__menu__item-icon[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__item-label[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__sub__item-label[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__item-tips[data-v-3d21bc0a],\n.__menu__item.disabled .__menu__sub__item-tips[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-icon[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-label[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__sub__item-label[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-tips[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__sub__item-tips[data-v-3d21bc0a] {\n  color: var(--menu-item-disabledColor);\n}\n.__menu__item.disabled .__menu__item-arrow .__menu__item-arrow-after[data-v-3d21bc0a],\n.__menu__sub__item.disabled .__menu__item-arrow .__menu__item-arrow-after[data-v-3d21bc0a] {\n  border-left: var(--menu-item-arrowRealSize) solid var(--menu-item-disabledColor);\n}\n.__menu__item[data-v-3d21bc0a]:not(.disabled):hover {\n  background: var(--menu-item-hoverBackground);\n}\n.__menu__item:not(.disabled):hover .__menu__item-icon[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverIconColor);\n}\n.__menu__item:not(.disabled):hover .__menu__item-label[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverLabelColor);\n}\n.__menu__item:not(.disabled):hover .__menu__item-tips[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverTipsColor);\n}\n.__menu__item:not(.disabled):hover .__menu__item-arrow[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverArrowColor);\n}\n.__menu__sub__item[data-v-3d21bc0a]:not(.disabled):hover {\n  background: var(--menu-item-hoverBackground);\n}\n.__menu__sub__item:not(.disabled):hover .__menu__sub__item-label[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverLabelColor);\n}\n.__menu__sub__item:not(.disabled):hover .__menu__sub__item-tips[data-v-3d21bc0a] {\n  color: var(--menu-item-hoverTipsColor);\n}\n.__menu__item-icon[data-v-3d21bc0a] {\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  line-height: 20px;\n  margin-right: 4px;\n}\n.__menu__item-arrow.show .__menu__item-arrow-after[data-v-3d21bc0a] {\n  position: absolute;\n  width: 0;\n  height: 0;\n  left: 8px;\n  border-left: var(--menu-item-arrowRealSize) solid var(--menu-item-arrowColor);\n  border-top: var(--menu-item-arrowRealSize) solid transparent;\n  border-bottom: var(--menu-item-arrowRealSize) solid transparent;\n}\n.__menu__sub__wrapper[data-v-3d21bc0a] {\n  position: fixed;\n  visibility: hidden;\n  width: 200px;\n  background: var(--menu-background);\n  box-shadow: var(--menu-boxShadow);\n  padding: var(--menu-padding);\n  border-radius: var(--menu-borderRadius);\n}\n.__menu__item:hover .__menu__sub__wrapper[data-v-3d21bc0a] {\n  visibility: visible;\n}"),l.render=function(e,n,t,a,i,o){return Vue.openBlock(),Vue.createBlock(Vue.Teleport,{to:"body",disabled:!e.appendToBody},[e.showMenu?(Vue.openBlock(),Vue.createElementBlock("div",{key:0,ref:"MenuWrapper",class:Vue.normalizeClass(["__menu__wrapper",e.customClass]),style:Vue.normalizeStyle({width:`${e.menuWidth}px`,top:`${e.menuTop}px`,left:`${e.menuLeft}px`})},[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.calcMenuList,((n,t)=>(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[n.hidden||n.line?Vue.createCommentVNode("v-if",!0):(Vue.openBlock(),Vue.createElementBlock("div",Vue.mergeProps({key:t,class:["__menu__item",n.disabled&&"disabled",n.customClass]},{[Vue.toHandlerKey(e.clickEventKey)]:Vue.withModifiers((t=>e.handleMenuItemClick(n,t)),["stop"])},{onMouseenter:t=>e.handleMenuMouseEnter(t,n)}),[e.hasIcon?(Vue.openBlock(),Vue.createElementBlock("div",s,["font-icon"===e.iconType?Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("i",{key:0,class:Vue.normalizeClass(n.icon)},null,2)),[[Vue.vShow,n.icon]]):"svg-icon"===e.iconType?Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",{key:1,class:"__menu__item-icon-svg",innerHTML:n.icon},null,8,c)),[[Vue.vShow,n.icon]]):"vnode-icon"===e.iconType?(Vue.openBlock(),Vue.createBlock(Vue.resolveDynamicComponent(n.icon),{key:2})):Vue.createCommentVNode("v-if",!0)])):Vue.createCommentVNode("v-if",!0),Vue.createElementVNode("span",p,Vue.toDisplayString(n.label),1),Vue.createElementVNode("span",b,Vue.toDisplayString(n.tips||""),1),e.hasSubMenu?(Vue.openBlock(),Vue.createElementBlock("span",{key:1,class:Vue.normalizeClass(["__menu__item-arrow",{show:e.hasSubMenu&&n.children}]),style:Vue.normalizeStyle({width:e.arrowSize+"px",height:e.arrowSize+"px"})},[Vue.withDirectives(Vue.createElementVNode("span",v,null,512),[[Vue.vShow,e.hasSubMenu&&n.children]])],6)):Vue.createCommentVNode("v-if",!0),n.children&&n.children.length>0?Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",{key:2,class:"__menu__sub__wrapper",style:Vue.normalizeStyle({top:`${e.subTop}px`,left:`${e.subLeft}px`})},[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(n.children,((n,t)=>(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[n.hidden||n.line?Vue.createCommentVNode("v-if",!0):(Vue.openBlock(),Vue.createElementBlock("div",Vue.mergeProps({key:t,class:["__menu__sub__item",n.disabled&&"disabled",n.customClass]},{[Vue.toHandlerKey(e.clickEventKey)]:Vue.withModifiers((t=>e.handleSubMenuItemClick(n,t)),["stop"])}),[Vue.createElementVNode("span",h,Vue.toDisplayString(n.label),1),Vue.createElementVNode("span",f,Vue.toDisplayString(n.tips||""),1)],16)),n.line?(Vue.openBlock(),Vue.createElementBlock("div",{key:t,class:"__menu__line"})):Vue.createCommentVNode("v-if",!0)],64)))),256))],4)),[[Vue.vShow,e.hoverFlag]]):Vue.createCommentVNode("v-if",!0)],16,d)),!n.hidden&&n.line?(Vue.openBlock(),Vue.createElementBlock("div",{key:t,class:"__menu__line"})):Vue.createCommentVNode("v-if",!0)],64)))),256))],6)):Vue.createCommentVNode("v-if",!0)],8,["disabled"])},l.__scopeId="data-v-3d21bc0a",l.__file="packages/mouse-menu/mouse-menu.vue",l.install=e=>{e.component(l.name,l)};export{y as useColumns};
