const e=function(t,n){if(n=n||{},!(this instanceof e))return new e(t,n);this.conf={styleStr:"",setDomHeightArr:[],printBeforeFn:null,printDoneCallBack:null};for(const e in this.conf)e&&n.hasOwnProperty(e)&&(this.conf[e]=n[e]);this.dom="string"==typeof t?document.querySelector(t):this.isDOM(t)?t:t.$el,this.conf.setDomHeightArr&&this.conf.setDomHeightArr.length&&this.setDomHeight(this.conf.setDomHeightArr),this.init()};e.prototype={init:function(){const e=this.getStyle()+this.getHtml();this.writeIframe(e)},extendOptions:function(e,t){for(const n in t)e[n]=t[n];return e},getStyle:function(){let e="";const t=document.querySelectorAll("style,link");for(let n=0;n<t.length;n++)e+=t[n].outerHTML;return e+=`<style>.no-print{display:none;}${this.conf.styleStr}</style>`,e},getHtml:function(){const e=document.querySelectorAll("input"),t=document.querySelectorAll("select"),n=document.querySelectorAll("textarea"),o=document.querySelectorAll("canvas");for(let r=0;r<e.length;r++)"checkbox"==e[r].type||"radio"==e[r].type?1==e[r].checked?e[r].setAttribute("checked","checked"):e[r].removeAttribute("checked"):(e[r].type,e[r].setAttribute("value",e[r].value));for(let r=0;r<n.length;r++)"textarea"==n[r].type&&(n[r].innerHTML=n[r].value);for(let r=0;r<t.length;r++)if("select-one"==t[r].type){const e=t[r].children;for(const t in e)"OPTION"==e[t].tagName&&(1==e[t].selected?e[t].setAttribute("selected","selected"):e[t].removeAttribute("selected"))}for(let r=0;r<o.length;r++){const e=o[r].toDataURL("image/png"),t=document.createElement("img");t.src=e,t.setAttribute("style","max-width: 100%;"),t.className="isNeedRemove",o[r].parentNode.insertBefore(t,o[r].nextElementSibling)}return this.dom.outerHTML},writeIframe:function(e){let t,n;const o=document.createElement("iframe"),r=document.body.appendChild(o);o.id="myIframe",o.setAttribute("style","position:absolute;width:0;height:0;top:-10px;left:-10px;"),t=r.contentWindow||r.contentDocument,n=r.contentDocument||r.contentWindow.document,n.open(),n.write(e),n.close();const c=document.querySelectorAll(".isNeedRemove");for(let l=0;l<c.length;l++)c[l].parentNode.removeChild(c[l]);const i=this;o.onload=function(){i.conf.printBeforeFn&&i.conf.printBeforeFn({doc:n}),i.toPrint(t),setTimeout((function(){document.body.removeChild(o),i.conf.printDoneCallBack&&i.conf.printDoneCallBack()}),100)}},toPrint:function(e){try{setTimeout((function(){e.focus(),e.document.execCommand("print",!1,null)||e.print(),e.close()}),10)}catch(t){}},isDOM:"object"==typeof HTMLElement?function(e){return e instanceof HTMLElement}:function(e){return e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName},setDomHeight(e){e&&e.length&&e.forEach((e=>{document.querySelectorAll(e).forEach((e=>{e.style.height=e.offsetHeight+"px"}))}))}};export{e as P};
